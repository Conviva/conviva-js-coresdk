/*! (C) 2021 Conviva, Inc. All rights reserved. Confidential and proprietary. */

!function(t,n){"function"===typeof define&&define.amd?define(n):("object"===typeof exports||"object"===typeof module&&module.exports)&&(module.exports=n()),"undefined"!==typeof t&&t&&(t.Conviva||t.ConvivaLoading||(t.ConvivaLoading=!0,t.Conviva=n(),delete t.ConvivaLoading))}(this,function(){var ut={};return function(){"use strict";var at={};!function(){var A=ut.Constants={};A.version="4.5.4",A.CUSTOMER_KEY="customerKey",A.GATEWAY_URL="gatewayUrl",A.LOG_LEVEL="logLevel",A.ASSET_NAME="Conviva.assetName",A.PLAYER_NAME="Conviva.applicationName",A.APPLICATION_VERSION="c3.app.version",A.IS_LIVE="Conviva.streamType",A.ENCODED_FRAMERATE="Conviva.encodedFrameRate",A.DEFAULT_RESOURCE="Conviva.defaultResource",A.STREAM_URL="Conviva.streamUrl",A.VIEWER_ID="Conviva.viewerId",A.DURATION="Conviva.duration",A.UTM_TRACKING_URL="c3.cm.utmTrackingUrl",A.POD_INDEX="podIndex",A.POD_POSITION="podPosition",A.POD_DURATION="podDuration",A.AD_TYPE="adType",A.MODULE_NAME="Conviva.moduleName",A.MODULE_VERSION="Conviva.moduleVersion",A.FRAMEWORK_NAME="Conviva.frameworkName",A.FRAMEWORK_VERSION="Conviva.frameworkVersion",A.i="Constants not yet configured",A.e="Invalid : Did you report playback ended?",A.s="Invalid : Did you report ad playback ended?",A.o="Player cannot be null",A.a="PlaybackAnlytics already built",A.u="PlaybackAnlytics not yet built",A.Playback={BITRATE:"BITRATE",PLAY_HEAD_TIME:"PLAY_HEAD_TIME",RESOLUTION:"RESOLUTION",BUFFER_LENGTH:"BUFFER_LENGTH",PLAYER_STATE:"PLAYER_STATE",RENDERED_FRAMERATE:"RENDERED_FRAMERATE",SEEK_STARTED:"SEEK_STARTED",SEEK_ENDED:"SEEK_ENDED",CDN_IP:"CDN_IP",DROPPED_FRAMES_TOTAL:"DROPPED_FRAMES_TOTAL",DROPPED_FRAMES_COUNT:"DROPPED_FRAMES_COUNT"},A.Network={SIGNAL_STRENGTH:"SIGNAL_STRENGTH",LINK_ENCRYPTION:"LINK_ENCRYPTION",CONNECTION_TYPE:"CONNECTION_TYPE"},A.ErrorSeverity={FATAL:1,WARNING:0},A.NO_SESSION_KEY=-2,A.AdPosition={PREROLL:"Pre-roll",MIDROLL:"Mid-roll",POSTROLL:"Post-roll"},A.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},A.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV"},A.AdType={CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},A.AdSlates={BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},A.AdServingType={INLINE:"Inline",WRAPPER:"Wrapper"},A.DeviceCategory={ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB",KAIOS_DEVICE:"KAIOS"},A.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},A.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},A.Events={USER_WAIT_STARTED:"Conviva.UserWaitStarted",USER_WAIT_ENDED:"Conviva.UserWaitEnded",BUMPER_VIDEO_STARTED:"Conviva.BumperVideoStarted",BUMPER_VIDEO_ENDED:"Conviva.BumperVideoEnded",AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},A.ErrorType={ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},A.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"},A.CallbackFunctions={CONSOLE_LOG:"consoleLog",MAKE_REQUEST:"makeRequest",SAVE_DATA:"saveData",LOAD_DATA:"loadData",GET_EPOCH_TIME_IN_MS:"getEpochTimeInMs",CREATE_TIMER:"createTimer",GENERATE_HASH:"generateHash",BASE64_ENCODE:"base64Encode"},A.DeviceMetadata={BRAND:"DeviceBrand",MANUFACTURER:"DeviceManufacturer",MODEL:"DeviceModel",TYPE:"DeviceType",VERSION:"DeviceVersion",OS_NAME:"OperatingSystemName",OS_VERSION:"OperatingSystemVersion",CATEGORY:"DeviceCategory",SCREEN_RESOLUTION_WIDTH:"ScreenWidth",SCREEN_RESOLUTION_HEIGHT:"ScreenHeight",SCREEN_RESOLUTION_SCALE_FACTOR:"ScaleFactor"},A.AD_PRELOAD_FEATURE="adPreloading",A.AD_TAG_URL="adTagUrl",A.IMASDK_CONTENT_PLAYER="imaMainContentPlayer",A.CONVIVA_AD_MODULE="convivaAdModule",A.CONVIVA_MODULE="convivaModule",A.MEDIA_ELEMENT="mediaElement";var h=ut.Client=function(){var u=this;this.c=!1,this.version=h.version,this.l=null,this.d=null,this.v=null,this.p=-1,this.g=null,this.y=null,this.A=null,this.S=null,this.R=-1,this.m=!1,this.C={},this.T=function(){u.l&&arguments.length>0&&u.l.info(" Client:: uniqueIdentifierCallback(): "+arguments[0])},this.I={},this.w=null,this.N=null,this.O=null,this._=function(){this.A.P("Client.makeIPV4IPV6GlobalSessions",function(){var t;!u.S||null!==(t=u.S.get(q.D))&&t!==B.M&&u.d&&((t=new f).custom["c3.IPV4IPV6GlobalSession"]="T",t.custom["c3.domain"]=u.g.L.indexOf(c.V)>-1?c.V:c.U,u.F=u.d.B(t,null),(t=new f).custom["c3.IPV4IPV6GlobalSession"]="T",t.custom["c3.domain"]=u.g.H.indexOf(c.G)>-1?c.G:c.K,u.j=u.d.B(t,null))})},this.W=function(i){u.A.P("Client.updateConnectionType",function(){if(u.w=i,u.d){var t,n=u.d.q();for(t in n)n[t].Y(i)}})},this.J=function(i){u.A.P("Client.updateLinkEncryption",function(){if(u.N=i,u.d){var t,n=u.d.q();for(t in n)n[t].X(i)}})},this.Q=function(t){u.A.P("Client.updateSignalStrength",function(){u.O=t})},function(t,n,i,e){if(!(t instanceof c))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(n instanceof g))throw new Error("systemFactory parameter should be an instance of SystemFactory.");t.gatewayUrl!==c.z+c.Z&&t.gatewayUrl!==c.$+c.Z||(this.c=!0),e&&(this.version=e),this.g=t.tt(),this.v=n,this.v.nt("SDK",this.g,this.version),this.A=this.v.it(this.version),this.A.P("Client.init",function(){if(u.R=$.et(),u.l=u.v.buildLogger(),u.l.setModuleName("Client"),u.c&&u.l.info("Gateway URL should not be set to https://cws.conviva.com or http://cws.conviva.com, therefore this call is ignored"),u.l.info("init(): url="+u.g.gatewayUrl+" customerKey="+u.g.customerKey),u.S=u.v.ot(),u.S.rt(),u.d=u.v.ut(u,u.g,u.S),i)for(var t in i)switch(t){case A.Network.CONNECTION_TYPE:u.W(i[t]);break;case A.Network.LINK_ENCRYPTION:u.J(i[t]);break;case A.Network.SIGNAL_STRENGTH:u.Q(i[t])}u._(),u.l.info("init(): done.")},function(t){throw new Error("Client constructor failed: "+t.message)})}.apply(this,arguments),this.release=function(){this.m||this.A.P("Client.release",function(){u.l&&(u.l.info("release()"),u.l=null),u.d.ht(),u.d=null,u.p=-1,u.R=-1,u.A=null,u.g=null,u.y=null,u.v=null,u.m=!0})},this.createSession=function(t,n,i){var e=h.NO_SESSION_KEY;return this.m||(!t||t instanceof f?this.A.P("Client.createSession",function(){e=u.d.ct(t,K.lt.ft,n,(i?A:u).version)}):u.l.error("createSession(): expecting an instance of ContentMetadata for contentMetadata parameter")),e},this.createAdSession=function(i,e,s,o,r){var a=h.NO_SESSION_KEY;return this.m||(!e||e instanceof f?this.A.P("Client.createAdSession",function(){var t,n;e||(e=new f),!Q.dt(i)||i===h.NO_SESSION_KEY||(t=u.d.vt(i))&&(n=e.custom[A.APPLICATION_VERSION],e.applicationName&&e.viewerId&&"undefined"!==typeof n&&n||t.Et&&t.Et.pt&&(!e.viewerId&&t.Et.pt.viewerId&&(e.viewerId=t.Et.pt.viewerId),!e.applicationName&&t.Et.pt.applicationName&&(e.applicationName=t.Et.pt.applicationName),"undefined"!==typeof n&&n||"undefined"!==typeof(n=t.Et.pt.custom[A.APPLICATION_VERSION])&&n&&(e.custom[A.APPLICATION_VERSION]=n)),e.custom["c3.csid"]=Q.gt(t.R)),a=u.d.ct(e,K.lt.yt,s,(o?A:u).version,r)}):u.l.error("createAdSession(): expecting an instance of ContentMetadata for adMetadata parameter")),a},this.reportError=function(n,i,e){this.m||(Q.At(i)?e===h.ErrorSeverity.FATAL||e===h.ErrorSeverity.WARNING?this.A.P("Client.reportError",function(){var t=u.d.vt(n);t&&t.St(i,e)}):this.l.error("reportError(): invalid error severity: "+e):this.l.error("reportError(): invalid error message string: "+i))},this.updateContentMetadata=function(i,e){this.m||(e instanceof f?this.A.P("Client.updateContentMetadata",function(){var t,n=u.d.vt(i);n&&(t=e.tt(),n.Rt(t))}):u.l.error("updateContentMetadata(): expecting an instance of ContentMetadata for contentMetadata parameter"))},this.detachPlayer=function(n){this.m||this.A.P("Client.detachPlayer",function(){var t=u.d.vt(n);t&&t.mt()})},this.Ct=function(n){this.m||this.A.P("Client.offFocus",function(){var t=u.d.vt(n);t&&t.Ct()})},this.attachPlayer=function(n,i){this.m||(i instanceof a?this.A.P("Client.attachPlayer",function(){var t=u.d.vt(n);t&&t.Tt(i)}):u.l.error("attachPlayer(): expecting an instance of PlayerStateManager for playerStateManager parameter"))},this.It=function(n){this.m||this.A.P("Client.onFocus",function(){var t=u.d.vt(n);t&&t.It()})},this.contentPreload=function(n){this.m||this.A.P("Client.contentPreload",function(){var t=u.d.vt(n);t&&t.wt()})},this.contentStart=function(n){this.m||this.A.P("Client.contentStart",function(){var t=u.d.vt(n);t&&t.Nt()})},this.sendCustomEvent=function(i,e,s){this.m||(Q.At(e)?(Q.Ot(s)<=0&&u.l.warning("eventAttributes(): should have proper data."),this.A.P("Client.sendCustomEvent",function(){i===h.NO_SESSION_KEY&&(u.p<0&&(n=new f,u.p=u.d.B(n,null)),i=u.p);var t=Q._t(s),n=u.d.Pt(i);n&&n.Dt(e,t)})):u.l.error("sendCustomEvent(): eventName parameter must be a valid string."))},this.adStart=function(n,i,e,s){this.m||(i===h.AdStream.CONTENT||i===h.AdStream.SEPARATE?e===h.AdPlayer.CONTENT||e===h.AdPlayer.SEPARATE?(s!==h.AdPosition.PREROLL&&s!==h.AdPosition.MIDROLL&&s!==h.AdPosition.POSTROLL&&this.l.info("adStart(): ignored, invalid value for adPosition parameter: "+s),this.A.P("Client.adStart",function(){var t=u.d.vt(n);t&&t.bt(i,e,s)})):this.l.error("adStart(): ignored, invalid value for adPlayer parameter: "+e):this.l.error("adStart(): ignored, invalid value for adStream parameter: "+i))},this.adEnd=function(n){this.m||this.A.P("Client.adEnd",function(){var t=u.d.vt(n);t&&t.Mt()})},this.cleanupSession=function(t){this.m||(t!==h.NO_SESSION_KEY?this.A.P("Client.cleanupSession",function(){u.d.vt(t)&&u.d.Lt(t)}):this.l.warning("cleanupSession(): ignored, can't cleanup Client.NO_SESSION_KEY"))},this.getAttachedPlayer=function(n){var i=null;return this.m||(n===h.NO_SESSION_KEY?this.l.warning("getAttachedPlayer(): ignored for Client.NO_SESSION_KEY"):this.A.P("Client.getAttachedPlayer",function(){var t=u.d.vt(n);t&&(i=t.Vt())})),i},this.isPlayerAttached=function(t){return!this.m&&null!==this.getAttachedPlayer(t)},this.getPlayerStateManager=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");return new a(this.v,(t?A:u).version)},this.releasePlayerStateManager=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");this.A.P("Client.releasePlayerStateManager",function(){t instanceof a&&t.release()})},this.kt=function(){return this.g},this.getId=function(){return this.R},this.getSessionId=function(n){if(this.m)return A.NO_SESSION_KEY;var i=null;return this.A.P("Client.getSessionId",function(){var t=u.d.vt(n);t&&(i=t.Ut())}),i},this.getClientId=function(n){if(this.m)return null;var i=null;return this.A.P("Client.getClientId",function(){var t=u.d.vt(n);t&&(i=t.Ft())}),i},this.Bt=function(n,i,e){this.m||this.A.P("Client.updateCustomMetric",function(){var t=u.d.vt(n);t&&t.Bt(i,e)})},this.setUniqueIdentifier=function(t,n){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||"undefined"===typeof t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var i in t)this.C[i]=t[i];n&&(this.T=n)},this.setUserPreferenceForDataCollection=function(t,n){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||"undefined"===typeof t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var i in t)"false"===t[i]?this.I[i]=n?q.Gt.Ht:q.Gt.Kt:this.I[i]=q.Gt.jt},this.setUserPreferenceForDataDeletion=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||"undefined"===typeof t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var n in t)"true"===t[n]?this.I[n]=q.Gt.xt:this.I[n]=q.Gt.jt}};h.version="4.5.4L",h.NO_SESSION_KEY=A.NO_SESSION_KEY,h.AdPosition={PREROLL:A.AdPosition.PREROLL,MIDROLL:A.AdPosition.MIDROLL,POSTROLL:A.AdPosition.POSTROLL},h.AdStream={CONTENT:A.AdPlayer.CONTENT,SEPARATE:A.AdPlayer.SEPARATE},h.AdPlayer={CONTENT:A.AdPlayer.CONTENT,SEPARATE:A.AdPlayer.SEPARATE},h.ErrorSeverity={FATAL:A.ErrorSeverity.FATAL,WARNING:A.ErrorSeverity.WARNING},h.DeviceType={DESKTOP:A.DeviceType.DESKTOP,CONSOLE:A.DeviceType.CONSOLE,SETTOP:A.DeviceType.SETTOP,MOBILE:A.DeviceType.MOBILE,TABLET:A.DeviceType.TABLET,SMARTTV:A.DeviceType.SMARTTV},h.AdTechnology={CLIENT_SIDE:A.AdType.CLIENT_SIDE,SERVER_SIDE:A.AdType.SERVER_SIDE},h.AdType={BLACKOUT_SLATE:A.AdSlates.BLACKOUT_SLATE,TECHNICAL_DIFFICULTIES_SLATE:A.AdSlates.TECHNICAL_DIFFICULTIES_SLATE,COMMERCIAL_SLATE:A.AdSlates.COMMERCIAL_SLATE,OTHER_SLATE:A.AdSlates.OTHER_SLATE,VPAID:A.AdSlates.VPAID,REGULAR:A.AdSlates.REGULAR},h.AdServingType={INLINE:A.AdServingType.INLINE,WRAPPER:A.AdServingType.WRAPPER},h.DeviceCategory={ANDROID_DEVICE:A.DeviceCategory.ANDROID_DEVICE,APPLE_DEVICE:A.DeviceCategory.APPLE_DEVICE,CHROMECAST:A.DeviceCategory.CHROMECAST,DESKTOP_APP:A.DeviceCategory.DESKTOP_APP,DEVICE_SIMULATOR:A.DeviceCategory.DEVICE_SIMULATOR,LG_TV:A.DeviceCategory.LG_TV,NINTENDO:A.DeviceCategory.NINTENDO,PLAYSTATION:A.DeviceCategory.PLAYSTATION,ROKU:A.DeviceCategory.ROKU,SAMSUNG_TV:A.DeviceCategory.SAMSUNG_TV,SMART_TV:A.DeviceCategory.SMART_TV,SET_TOP_BOX:A.DeviceCategory.SET_TOP_BOX,TIVO:A.DeviceCategory.TIVO,WEB:A.DeviceCategory.WEB,WINDOWS_DEVICE:A.DeviceCategory.WINDOWS_DEVICE,XBOX:A.DeviceCategory.XBOX,KAIOS_DEVICE:A.DeviceCategory.KAIOS_DEVICE};var c=ut.ClientSettings=function(){var i=this;this.Wt=null,Q.qt(this,"customerKey",function(){return this.Wt}),Q.Yt(this,"customerKey",function(t){Q.At(t)&&(this.Wt=t)}),this.Jt=c.Xt,Q.qt(this,"heartbeatInterval",function(){return this.Jt}),Q.Yt(this,"heartbeatInterval",function(t){var n;"number"!==typeof t||(n=Q.Qt(t))===t&&(this.Jt=n)}),this.zt=null,this.L=null,this.H=null,Q.qt(this,"gatewayUrl",function(){return this.zt}),Q.Yt(this,"gatewayUrl",function(t){var n;Q.At(t)&&("https"!==(n=t.split("://"))[0]&&"http"!==n[0]||-1!==t.indexOf(".com",t.length-".com".length)&&(this.zt=t))}),function(t){if(!Q.At(t))throw new Error("customerKey must be valid");this.customerKey=t}.apply(this,arguments),this.equals=function(t){return this.customerKey===t.customerKey&&this.gatewayUrl===t.gatewayUrl&&this.heartbeatInterval===t.heartbeatInterval},this.tt=function(){var t=new c(this.customerKey);return t.gatewayUrl=function(t){if(Q.At(t)){var n=t.split("://");if(-1===n[1].indexOf("cws.conviva.com")&&("https"===n[0]||"http"===n[0]))return i.L="https://"+i.customerKey+"."+c.U,i.H="https://"+i.customerKey+"."+c.K,t}return i.L="https://"+i.customerKey+"."+c.V,i.H="https://"+i.customerKey+"."+c.G,"https://"+i.customerKey+"."+c.Z}(this.gatewayUrl),t.heartbeatInterval=this.heartbeatInterval,t.L=this.L,t.H=this.H,t}};c.Zt="https://conviva.testonly.conviva.com",c.$t="https://cws.conviva.com",c.Z="cws.conviva.com",c.V="ipv4.cws.conviva.com",c.G="ipv6.cws.conviva.com",c.tn="conviva.testonly.conviva.com",c.U="ipv4.testonly.conviva.com",c.K="ipv6.testonly.conviva.com",c.z="https://",c.$="http://",c.nn=5,c.Xt=20;var f=ut.ContentMetadata=function(){this.in=null,Q.qt(this,"assetName",function(){return this.in}),Q.Yt(this,"assetName",function(t){if("string"!==typeof t)return;this.in=t}),this.en={},Q.qt(this,"custom",function(){return this.en}),Q.Yt(this,"custom",function(t){if("object"!==typeof t)return;this.en=Q._t(t)}),this.sn=null,Q.qt(this,"defaultResource",function(){return this.sn}),Q.Yt(this,"defaultResource",function(t){if("string"!==typeof t)return;this.sn=t}),this.on=null,Q.qt(this,"viewerId",function(){return this.on}),Q.Yt(this,"viewerId",function(t){if("string"!==typeof t)return;this.on=t}),this.rn=null,Q.qt(this,"applicationName",function(){return this.rn}),Q.Yt(this,"applicationName",function(t){if("string"!==typeof t)return;this.rn=t}),this.an=null,Q.qt(this,"streamUrl",function(){return this.an}),Q.Yt(this,"streamUrl",function(t){if("string"!==typeof t)return;this.an=t}),this.un=f.StreamType.UNKNOWN,Q.qt(this,"streamType",function(){return this.un}),Q.Yt(this,"streamType",function(t){t!==f.StreamType.UNKNOWN&&t!==f.StreamType.VOD&&t!==f.StreamType.LIVE||(this.un=t)}),this.hn=-1,Q.qt(this,"duration",function(){return this.hn}),Q.Yt(this,"duration",function(t){this.hn=tt.cn(t)}),this.fn=-1,Q.qt(this,"encodedFrameRate",function(){return this.fn}),Q.Yt(this,"encodedFrameRate",function(t){this.fn=tt.cn(t)}),function(){}.apply(this,arguments),this.tt=function(){var t,n=new f;for(t in n.assetName=this.assetName,n.applicationName=this.applicationName,n.streamUrl=this.streamUrl,n.viewerId=this.viewerId,n.defaultResource=this.defaultResource,n.streamType=this.streamType,n.duration=this.duration,n.encodedFrameRate=this.encodedFrameRate,this.custom)n.custom[t]=this.custom[t];return n}};f.StreamType={UNKNOWN:A.StreamType.UNKNOWN,LIVE:A.StreamType.LIVE,VOD:A.StreamType.VOD},ut.ErrorType={ERROR_UNKNOWN:A.ErrorType.ERROR_UNKNOWN,ERROR_IO:A.ErrorType.ERROR_IO,ERROR_TIMEOUT:A.ErrorType.ERROR_TIMEOUT,ERROR_NULL_ASSET:A.ErrorType.ERROR_NULL_ASSET,ERROR_MISSING_PARAMETER:A.ErrorType.ERROR_MISSING_PARAMETER,ERROR_NO_AD_AVAILABLE:A.ErrorType.ERROR_NO_AD_AVAILABLE,ERROR_PARSE:A.ErrorType.ERROR_PARSE,ERROR_INVALID_VALUE:A.ErrorType.ERROR_INVALID_VALUE,ERROR_INVALID_SLOT:A.ErrorType.ERROR_INVALID_SLOT,ERROR_3P_COMPONENT:A.ErrorType.ERROR_3P_COMPONENT,ERROR_UNSUPPORTED_3P_FEATURE:A.ErrorType.ERROR_UNSUPPORTED_3P_FEATURE,ERROR_DEVICE_LIMIT:A.ErrorType.ERROR_DEVICE_LIMIT,ERROR_UNMATCHED_SLOT_SIZE:A.ErrorType.ERROR_UNMATCHED_SLOT_SIZE},ut.Events={AD_REQUESTED:A.Events.AD_REQUESTED,AD_RESPONSE:A.Events.AD_RESPONSE,AD_SLOT_STARTED:A.Events.AD_SLOT_STARTED,AD_ATTEMPTED:A.Events.AD_ATTEMPTED,AD_SLOT_ENDED:A.Events.AD_SLOT_ENDED,AD_IMPRESSION_START:A.Events.AD_IMPRESSION_START,AD_START:A.Events.AD_START,AD_FIRST_QUARTILE:A.Events.AD_FIRST_QUARTILE,AD_MID_QUARTILE:A.Events.AD_MID_QUARTILE,AD_THIRD_QUARTILE:A.Events.AD_THIRD_QUARTILE,AD_COMPLETE:A.Events.AD_COMPLETE,AD_END:A.Events.AD_END,AD_IMPRESSION_END:A.Events.AD_IMPRESSION_END,AD_SKIPPED:A.Events.AD_SKIPPED,AD_ERROR:A.Events.AD_ERROR,AD_PROGRESS:A.Events.AD_PROGRESS,AD_CLOSE:A.Events.AD_CLOSE,CONTENT_PAUSED:A.Events.CONTENT_PAUSED,CONTENT_RESUMED:A.Events.CONTENT_RESUMED,POD_START:A.Events.POD_START,POD_END:A.Events.POD_END};var a=ut.PlayerStateManager=function(){var e=this;e.ln=null,e.dn=-2,e.vn=a.PlayerState.UNKNOWN,e.En={},e.pn=-2,e.fn=-2,e.hn=-2,e.gn=null,e.yn=null,e.an=null,e.An=null,e.Sn=null,e.Rn=-1,e.mn=-1,e.w=null,e.N=null,e.Cn=null,e.Tn=[],e.m=!1,this.release=function(){e.m||e.A.P("PlayerStateManager.release",function(){e.ln&&e.ln.In(),e.wn(),e.v=null,e.l=null,e.A=null,e.m=!0})},this.setPlayheadTime=function(){},this.setBufferLength=function(){},this.setRenderedFrameRate=function(){},this.getEncodedFrameRate=function(){return e.fn},this.setEncodedFrameRate=function(n){e.m||e.A.P("PlayerStateManager.setEncodedFrameRate",function(){var t=tt.cn(n);t>=-1&&(e.fn=t,e.ln&&e.ln.Nn(e.fn))})},this.getDuration=function(){return e.hn},this.setClientMeasureInterface=function(t){Q.On(t,new ut.ClientMeasureInterface,"ClientMeasureInterface"),this._n=t},this.getPHT=function(){return this._n&&"function"===typeof this._n.getPHT?this._n.getPHT():a.DEFAULT_PHT},this.getBufferLength=function(){return this._n&&"function"===typeof this._n.getBufferLength?this._n.getBufferLength():a.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this._n&&"function"===typeof this._n.getSignalStrength?this._n.getSignalStrength():a.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this._n&&"function"===typeof this._n.getRenderedFrameRate?this._n.getRenderedFrameRate():a.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(n){e.m||e.A.P("PlayerStateManager.setDuration",function(){var t=tt.cn(n);t>=-1&&(e.hn=t,e.ln&&e.ln.Pn(e.hn))})},this.getStreamUrl=function(){return e.an},this.setStreamUrl=function(t){e.m||e.A.P("PlayerStateManager.setStreamUrl",function(){t&&(e.an=t,e.ln&&e.ln.Dn(e.an))})},this.bn=function(){return e.An},this.Mn=function(){return e.Sn},this.setModuleNameAndVersion=function(t,n){e.An=t,e.Sn=n},this.Ln=function(){return e.yn},this.setPlayerType=function(t){e.m||e.A.P("PlayerStateManager.setPlayerType",function(){e.yn=t,e.ln&&e.ln.Vn(e.yn)})},this.kn=function(){return e.gn},this.setPlayerVersion=function(t){e.m||e.A.P("PlayerStateManager.setPlayerVersion",function(){e.gn=t,e.ln&&e.ln.Un(e.gn)})},this.setMonitoringNotifier=function(t){return!e.m&&(!e.ln&&(e.ln=t,e.l&&arguments.length>=2&&e.l.Fn(arguments[1]),!0))},this.wn=function(){e.m||(e.ln=null,e.l&&e.l.Fn(null))},this.Bn=function(){e.setPlayerState(e.getPlayerState()),e.setBitrateKbps(e.Hn()),e.setDuration(e.getDuration()),e.setEncodedFrameRate(e.getEncodedFrameRate()),e.setStreamUrl(e.getStreamUrl()),e.setPlayerType(e.Ln()),e.setPlayerVersion(e.kn());for(var t=0;t<e.Tn.length;t++){var n=e.Tn[t];e.Gn(n)}e.Tn=[]},this.getPlayerState=function(){return e.vn},this.setPlayerState=function(t){e.m||e.A.P("PlayerStateManager.setPlayerState",function(){a.Kn(t)?(e.vn=t,e.ln&&e.ln.jn(e.vn)):e.l.error("PlayerStateManager.SetPlayerState(): invalid state: "+t)})},this.Hn=function(){return e.dn},this.setBitrateKbps=function(n){e.m||e.A.P("PlayerStateManager.setBitrateKbps",function(){var t=tt.cn(n);t>=-1&&(e.dn=t,e.ln&&e.ln.xn(e.dn))})},this.setPlayerSeekStart=function(t){e.m||e.A.P("PlayerStateManager.setPlayerSeekStart()",function(){e.ln&&e.ln.Wn(a.SEEK_ACTIONS_TYPE.SEEK_START,t)})},this.setPlayerSeekEnd=function(){e.m||e.A.P("PlayerStateManager.setPlayerSeekEnd()",function(){e.ln&&e.ln.Wn(a.SEEK_ACTIONS_TYPE.SEEK_END,-1)})},this.setUserSeekButtonUp=function(){e.m||e.A.P("PlayerStateManager.setUserSeekButtonUp()",function(){e.ln&&e.ln.Wn(a.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)})},this.setUserSeekButtonDown=function(){e.m||e.A.P("PlayerStateManager.setUserSeekButtonDown()",function(){e.ln&&e.ln.Wn(a.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)})},this.setVideoResolutionWidth=function(n){e.m||e.A.P("PlayerStateManager.setVideoResolutionWidth()",function(){var t=tt.cn(n);t>0&&(e.Rn=t),e.ln&&e.ln.qn(e.Rn)})},this.setVideoResolutionHeight=function(n){e.m||e.A.P("PlayerStateManager.setVideoResolutionHeight()",function(){var t=tt.cn(n);t>0&&(e.mn=t),e.ln&&e.ln.Yn(e.mn)})},this.setConnectionType=function(t){e.m||e.A.P("PlayerStateManager.setConnectionType()",function(){e.w=t,e.ln&&e.ln.Y(e.w)})},this.setLinkEncryption=function(t){e.m||e.A.P("PlayerStateManager.setLinkEncryption()",function(){e.N=t,e.ln&&e.ln.X(e.N)})},this.setSignalStrength=function(){},this.Gn=function(t){var n,i;e.Cn=t,e.ln?(n=t.errorCode,i=t.severity,e.ln.Jn(n,i)):e.Tn.push(t)},this.sendError=function(n,i){e.m||e.A.P("PlayerStateManager.sendError",function(){var t=new nt(n,i);e.Gn(t)})},this.reset=function(){e.m||e.A.P("PlayerStateManager.reset",function(){e.dn=-2,e.vn=a.PlayerState.UNKNOWN,e.En={},e.pn=-1,e.fn=-1,e.hn=-1,e.gn=null,e.yn=null,e.an=null,e.Cn=null,e.Tn=[]})},this.setCDNServerIP=function(t){e.m||e.A.P("PlayerStateManager.setCDNServerIP",function(){e.ln&&e.ln.Xn(t)})},this.Qn=function(){return e.zn},this.setDroppedFramesTotal=function(t){e.m||e.A.P("PlayerStateManager.setDroppedFramesTotal",function(){e.ln&&e.ln.Zn(t)})},this.setDroppedFramesCount=function(t){e.m||e.A.P("PlayerStateManager.setDroppedFramesCount",function(){e.ln&&e.ln.$n(t)})},this.ti=function(){return e.Cn},function(t,n){e.v=t,e.l=e.v.buildLogger(),e.l.setModuleName("PlayerStateManager"),e.A=e.v.it(n)}.apply(e,arguments)};a.PlayerState={STOPPED:A.PlayerState.STOPPED,PLAYING:A.PlayerState.PLAYING,BUFFERING:A.PlayerState.BUFFERING,PAUSED:A.PlayerState.PAUSED,UNKNOWN:A.PlayerState.UNKNOWN,NOT_MONITORED:A.PlayerState.NOT_MONITORED},a.Kn=function(t){return t===a.PlayerState.STOPPED||t===a.PlayerState.PLAYING||t===a.PlayerState.BUFFERING||t===a.PlayerState.PAUSED||t===a.PlayerState.UNKNOWN||t===a.PlayerState.NOT_MONITORED},a.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"},a.DEFAULT_SIGNAL_STRENGTH=1e3,a.DEFAULT_RENDERED_FRAME_RATE=-1,a.DEFAULT_BUFFER_LENGTH=-1,a.DEFAULT_PHT=-1,ut.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}};var r=ut.HttpInterface=function(){this.makeRequest=function(){},this.release=function(){}},u=ut.LoggingInterface=function(){this.consoleLog=function(){},this.release=function(){}},l=ut.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.getScreenWidth=function(){},this.getScreenHeight=function(){},this.getScaleFactor=function(){},this.release=function(){}},d=ut.StorageInterface=function(){this.saveData=function(){},this.loadData=function(){},this.release=function(){}},v=ut.SystemInterface=function(){(function(t,n,i,e,s,o){Q.On(t,new E,"TimeInterface"),Q.On(n,new p,"TimerInterface"),Q.On(i,new r,"HttpInterface"),Q.On(e,new d,"StorageInterface"),Q.On(s,new l,"MetadataInterface"),Q.On(o,new u,"LoggingInterface"),this.ni=t,this.ii=n,this.ei=i,this.si=e,this.oi=s,this.ri=o}).apply(this,arguments),this.release=function(){this.ni&&(this.ni.release(),this.ni=null),this.ii&&(this.ii.release(),this.ii=null),this.ei&&(this.ei.release(),this.ei=null),this.si&&(this.si.release(),this.si=null),this.oi&&(this.oi.release(),this.oi=null),this.ri&&(this.ri.release(),this.ri=null)}},E=ut.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},p=ut.TimerInterface=function(){this.createTimer=function(){},this.release=function(){}},g=ut.SystemFactory=function(){var t=this;(function(t,n){if(!(t instanceof v))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this.ai=t,this.ni=this.ai.ni,this.ii=this.ai.ii,this.ei=this.ai.ei,this.si=this.ai.si,this.oi=this.ai.oi,this.ri=this.ai.ri,this.g=n instanceof y?n.tt():new y}).apply(this,arguments),this.nt=function(t,n,i){this.ui=t,this.hi=n,this.ci=i},this.release=function(){this.ai.release(),this.ai=null,this.ui=null,this.g=null,this.fi=null};var n=function(){return new et(t.ri,t.ni,t.kt(),t.fi,t.ui)};this.buildLogger=function(){return n()},this.ut=function(t,n,i){return new x(t,n,i,this)},this.li=function(t){return new Z(this.buildLogger(),this.di(),this.hi,t)},this.vi=function(){return new W(this.buildTimer(t.ci))},this.Ei=function(){var t=new rt(this.buildLogger(),this.ii,new J(this.buildLogger(),null,this.kt()));return new W(t)},this.di=function(){return new it(this.buildLogger(),this.ei,this.Ei(),this.kt())},this.it=function(t){return new J(this.buildLogger(),this.li(t),this.kt())},this.buildTime=function(){return new ot(this.ni,this.buildLogger())},this.buildTimer=function(t){return new rt(this.buildLogger(),this.ii,this.it(t))},this.pi=function(){return new at.Storage(this.buildLogger(),this.si,this.vi(),this.kt())},this.ot=function(){return new q(this.buildLogger(),this.pi(),this.gi())},this.yi=function(t){return new st(this.buildLogger(),this.oi,this.it(t))},this.Ai=function(){return new B},this.Si=function(t,n){return new X(t,this.buildLogger(),this.di(),this.gi(),n)},this.Ri=function(t,n,i,e,s){var o=this.Si(n,e.custom["c3.domain"]);return new K(this.mi(),t,n,this.buildLogger(),this.it(s),this.buildTimer(s),o,this.Ai(),this.buildTime(),this.Ci(),i,e,s)},this.Ti=function(t,n,i,e,s,o,r){o=this.Ri(t,n.tt(),i,o,r);return new j(e,s,i,this.yi(r),o,this.it(r),this.buildLogger())},this.mi=function(){return new Y},this.gi=function(){return new H},this.Ci=function(){return this.fi},this.kt=function(){return this.g},this.fi=new z},y=ut.SystemSettings=function(){this.Ii=y.wi,Q.qt(this,"logLevel",function(){return this.Ii}),Q.Yt(this,"logLevel",function(t){var n;"number"!==typeof t||(n=Q.Qt(t))===t&&n>=y.LogLevel.DEBUG&&n<=y.LogLevel.ERROR&&(this.Ii=n)}),this.Ni=y.Oi,Q.qt(this,"allowUncaughtExceptions",function(){return this.Ni}),Q.Yt(this,"allowUncaughtExceptions",function(t){Q._i(t)&&(this.Ni=t)}),this.Pi=y.Di,Q.qt(this,"storageTimeout",function(){return this.Pi}),Q.Yt(this,"storageTimeout",function(t){var n;"number"!==typeof t||(n=Q.Qt(t))===t&&(this.Pi=n)}),this.bi=y.Mi,Q.qt(this,"httpTimeout",function(){return this.bi}),Q.Yt(this,"httpTimeout",function(t){var n;"number"!==typeof t||(n=Q.Qt(t))===t&&(this.bi=n)}),function(){}.apply(this,arguments),this.equals=function(t){return this.logLevel===t.logLevel&&this.allowUncaughtExceptions===t.allowUncaughtExceptions&&this.storageTimeout===t.storageTimeout&&this.httpTimeout===t.httpTimeout},this.tt=function(){var t=new y;return t.logLevel=this.logLevel,t.allowUncaughtExceptions=this.allowUncaughtExceptions,t.storageTimeout=this.storageTimeout,t.httpTimeout=this.httpTimeout,t}};y.LogLevel={DEBUG:A.LogLevel.DEBUG,INFO:A.LogLevel.INFO,WARNING:A.LogLevel.WARNING,ERROR:A.LogLevel.ERROR,NONE:A.LogLevel.NONE},y.Li=y.LogLevel.DEBUG,y.wi=y.LogLevel.NONE,y.Vi=!0,y.Oi=!1,y.Di=10,y.Mi=10;var i=at.AdAnalytics=function(){var e=this;function n(t){e.ki?(Q.Ot(t)>0&&e.setAdInfo(t),e.ki.Ui()||(e.ki.Fi(e.Bi),e.ki.Hi(!0))):e.l&&e.l.error("AdAnalytics.onAdInitiated() : contentPlayer - "+A.e)}e.Gi=null,e.l=null,e.v=null,e.Ki=null,e.Bi=null,e.ki=null,e.ji=null,e.xi=null,e.Wi=null,function(t,n,i){e.Gi=t,e.Wi=i,e.v=n,i&&(e.Bi=i.qi()),e.Ki=n.buildTimer(A.version),e.l=n.buildLogger(),e.l.setModuleName("AdAnalytics"),e.ki=new o(e.Gi,e.Ki),R.call(this)}.apply(this,arguments),this.setAdInfo=function(t){Q.Ot(t)<=0?e.l&&e.l.error("AdAnalytics.setAdInfo() : AD Info is not set"):(e.l&&e.l.debug("AdAnalytics.setAdInfo()"),e.ki&&e.ki.Yi(t))},this.setAdPlayerInfo=function(t){Q.Ot(t)<=0?e.l&&e.l.error("AdAnalytics.setAdPlayerInfo() : Ad Player Info is not set"):(e.l&&e.l.debug("AdAnalytics.setAdPlayerInfo()"),e.ki&&e.ki.Yi(t))},this.reportAdMetric=function(){0!==arguments.length?1===arguments.length?e.Ji(arguments[0]):2===arguments.length?e.Ji(arguments[0],arguments[1]):3===arguments.length?e.Ji(arguments[0],arguments[1],arguments[2]):4===arguments.length&&e.Ji(arguments[0],arguments[1],arguments[2],arguments[3]):e.l&&e.l.error("AdAnalytics.reportAdMetric() : Need to report metric mandatory")},this.setCallback=function(t){e.ki&&e.ki.Xi(t)},this.reportAdFailed=function(t,n){e.ki?(Q.Ot(n)>0&&e.setAdInfo(n),e.ki.Ui()?(e.l&&e.l.debug("AdAnalytics.reportAdFailed() : "+t),e.reportAdError(t,h.ErrorSeverity.FATAL),e.reportAdEnded()):(e.ki.Fi(e.Bi),e.l&&e.l.debug("AdAnalytics.reportAdFailed() : "+t),t=new nt(t,h.ErrorSeverity.FATAL),e.ki.Hi(!0,t))):e.l&&e.l.error("AdAnalytics.reportAdFailed() : "+A.e)},this.reportAdLoaded=function(t){e.l&&e.l.debug("AdAnalytics.reportAdLoaded()"),n(t)},this.reportAdStarted=function(t){e.l&&e.l.debug("AdAnalytics.reportAdStarted()"),n(t)},this.reportAdEnded=function(){e.ki?(e.l&&e.l.debug("AdAnalytics.reportAdEnded()"),e.ki.Ui()&&(e.ki.Fi(null),e.ki.Hi(!1))):e.l&&e.l.error("AdAnalytics.reportAdEnded() : "+A.s)},this.reportAdError=function(t,n){e.ki?(e.l&&e.l.debug("AdAnalytics.reportAdError() : "+t),n=new nt(t,n),e.ki.Gn(n)):e.l&&e.l.error("AdAnalytics.reportAdError() : "+A.e)},this.reportAdPlayerEvent=function(t,n){if(Q.At(t))if(e.l&&e.l.debug("AdAnalytics.reportAdPlayerEvent()"),e.ki)switch(t){case A.Events.USER_WAIT_STARTED:case A.Events.BUMPER_VIDEO_STARTED:e.ki.mt();break;case A.Events.USER_WAIT_ENDED:case A.Events.BUMPER_VIDEO_ENDED:e.ki.Tt();break;default:e.ki.Qi(t,n)}else e.l&&e.l.error("AdAnalytics.reportAdPlayerEvent() : "+A.e);else e.l&&e.l.error("AdAnalytics.reportAdPlayerEvent(): eventType parameter must be a valid string.")},this.reportAdSkipped=function(){e.ki?(e.l&&e.l.debug("AdAnalytics.reportAdSkipped()"),e.reportAdPlayerEvent(A.Events.AD_SKIPPED),e.reportAdEnded()):e.l&&e.l.error("AdAnalytics.reportAdSkipped() : "+A.e)},this.release=function(){e.l&&e.l.debug("AdAnalytics.release()"),e.ki&&(e.ki.Ui()&&(e.ki.Fi(null),e.ki.Hi(!1)),e.ki.Xi(null),e.ki.zi(),e.ki=null),"undefined"!==typeof ut.AdProxyMonitor&&e.xi&&(ut.AdProxyMonitor.release(e.xi),e.xi=null)},this.setAdListener=function(t,n){t?("undefined"!==typeof n&&"undefined"!==typeof n.convivaModule?ut.AdProxyMonitor=n.convivaModule.AdProxyMonitor:"undefined"!==typeof ConvivaModule&&(ut.AdProxyMonitor=ConvivaModule.AdProxyMonitor),"undefined"!==typeof ut.AdProxyMonitor?!t&&e.xi?(ut.AdProxyMonitor.release(e.xi),e.xi=null):t&&e.xi?(ut.AdProxyMonitor.release(e.xi),e.l&&e.l.debug("AdAnalytics.setAdListener() : Initializing ad drop-in module"),e.xi=ut.AdProxyMonitor.initConvivaDropIn(t,n,this,ut,e.v)):t&&!e.xi&&(e.l&&e.l.debug("AdAnalytics.setAdListener() : Initializing ad drop-in module"),e.xi=ut.AdProxyMonitor.initConvivaDropIn(t,n,this,ut,e.v)):e.l.error("AdAnalytics.setAdListener() : Include the missing Ads SDK Module")):e.l.error("AdAnalytics.setAdListener() : Need to configure the adListener instance")},this.reportAdBreakStarted=function(t,n,i){e.Bi?(e.l&&e.l.debug("AdAnalytics.reportAdBreakStarted()"),e.Zi=t,e.ji=n,e.Bi.$i(t,n,i)):e.l.error("AdAnalytics.reportAdBreakStarted() : "+A.e)},this.reportAdBreakEnded=function(){e.Bi?(e.l&&e.l.debug("AdAnalytics.reportAdBreakEnded()"),e.Zi=null,e.ji=null,e.Bi.te()):e.l.error("AdAnalytics.reportAdBreakEnded() : "+A.e)},this.getSessionId=function(){return e.Bi?(e.l&&e.l.debug("VideoAnalytics.getSessionId()"),e.ki.Ut()):(e.l.error("VideoAnalytics.getSessionId() : "+A.e),A.NO_SESSION_KEY)},this.getClientId=function(){return e.Bi?(e.l&&e.l.debug("VideoAnalytics.getClientId()"),e.ki.Ft()):(e.l.error("VideoAnalytics.getClientId() : "+A.e),null)},this.getPlayerMonitor=function(){return e.Bi},this.getAdPlayerMonitor=function(){return e.ki},this.getVideoAnalytics=function(){return e.Wi},this.getAdType=function(){return e.Bi?e.Bi.Zi:null},this.ne=function(){return e.Bi?e.Bi.ji:null},i.prototype=Object.create(R.prototype),i.prototype.constructor=i},o=at.AdPlayerMonitorImpl=function(){var s=this;s.ie=null,s.ee=null,function(t,n){m.call(this,t,n)}.apply(this,arguments),this.Fi=function(t){this.se()!==t&&(this.oe(),s.ee=t||null)},this.se=function(){return s.ee},this.re=function(t){var n,i=this.se(),e={};e.error=t,s.ie&&(s.ae=s.ie.getPlayerStateManager(!0),s.ue(),s.ae.setClientMeasureInterface(this),n=null,i&&(n=i.he()),s.ce=s.ie.createAdSession(n,s.pt,s.ae,!0,e),"undefined"!==typeof t&&(s.fe(),s.zi()))},o.prototype=Object.create(m.prototype),o.prototype.constructor=o},S=ut.Analytics={init:function(t,n,i){if(this.Gi)this.l.error("Client is already configured");else{if(arguments.length<=0)throw new Error("customerKey must be valid");var e=null,s=null,o=null;if("string"===typeof t&&(e=t,!Q.At(e)))throw new Error("customerKey must be valid");arguments.length>=2&&"object"===typeof n&&(s=n),arguments.length>=3&&"object"===typeof i&&(o=i);var r=new c(e),a=new y;Q.Ot(o)>0&&(o[A.GATEWAY_URL]&&(r.gatewayUrl=o[A.GATEWAY_URL]),o[A.LOG_LEVEL]>=0&&(a.logLevel=o[A.LOG_LEVEL]));t=new ut.Impl.Html5Logging,n=new ut.Impl.Html5Storage,i=new ut.Impl.Html5Http,e=new ut.Impl.Html5Timer,o=new ut.Impl.Html5Time;this.oi||(this.oi=new ut.Impl.Html5Metadata),s&&(s[A.CallbackFunctions.CONSOLE_LOG]&&(t.consoleLog=s[A.CallbackFunctions.CONSOLE_LOG]),s[A.CallbackFunctions.MAKE_REQUEST]&&(i.makeRequest=s[A.CallbackFunctions.MAKE_REQUEST]),s[A.CallbackFunctions.SAVE_DATA]&&(n.saveData=s[A.CallbackFunctions.SAVE_DATA]),s[A.CallbackFunctions.LOAD_DATA]&&(n.loadData=s[A.CallbackFunctions.LOAD_DATA]),s[A.CallbackFunctions.GET_EPOCH_TIME_IN_MS]&&(o.getEpochTimeMs=s[A.CallbackFunctions.GET_EPOCH_TIME_IN_MS]),s[A.CallbackFunctions.CREATE_TIMER]&&(e.createTimer=s[A.CallbackFunctions.CREATE_TIMER])),this.ai=new v(o,e,i,n,this.oi,t),this.v=new g(this.ai,a),this.v.nt("Analytics",r),this.Gi=new h(r,this.v,this.le,S.version),this.l=this.v.buildLogger(),this.l.setModuleName("Analytics")}},release:function(){var t=0;if(this.de){for(t=0;t<this.de.length;t++){var n=this.de[t];n&&(n.release(),n.l=null,n.Ki=null,this.de.splice(t,1),t--)}this.de=null}if(this.ve){for(t=0;t<this.ve.length;t++){var i=this.ve[t];i&&(i.release(),i.l=null,i.Ki=null,this.ve.splice(t,1),t--)}this.ve=null}this.v&&(this.v.release(),this.v=null),this.Gi&&(this.Gi.release(),this.Gi=null),this.Gi=null,this.l=null,this.ai=null,this.oi=null,this.le=null},setUniqueIdentifier:function(t,n){if(!this.Gi)throw new Error(A.i);this.Gi.setUniqueIdentifier(t,n)},setUserPreferenceForDataCollection:function(t,n){if(!this.Gi)throw new Error(A.i);this.Gi.setUserPreferenceForDataCollection(t,n)},setUserPreferenceForDataDeletion:function(t){if(!this.Gi)throw new Error(A.i);this.Gi.setUserPreferenceForDataDeletion(t)},reportAppEvent:function(t,n){if(!this.Gi)throw new Error(A.i);this.Gi.sendCustomEvent(h.NO_SESSION_KEY,t,n)},reportAppBackgrounded:function(){if(!this.Gi)throw new Error(A.i);this.Gi.sendCustomEvent(h.NO_SESSION_KEY,"App.Backgrounded",null)},reportAppForegrounded:function(){if(!this.Gi)throw new Error(A.i);this.Gi.sendCustomEvent(h.NO_SESSION_KEY,"App.Foregrounded",null)},configureExistingClient:function(t){if(!(t instanceof h))throw new Error(A.i);this.Gi=t,this.v=this.Gi.v,this.l=this.v.buildLogger(),this.l.setModuleName("Analytics")},buildVideoAnalytics:function(){if(!this.Gi)throw new Error(A.i);var t=new w(this.Gi,this.v);return this.ve||(this.ve=[]),this.ve.push(t),t},buildAdAnalytics:function(t){if(!this.Gi)throw new Error(A.i);t=new i(this.Gi,this.v,t||null);return this.de||(this.de=[]),this.de.push(t),t},setDeviceMetadata:function(t){var n,i,e;arguments.length<=0||0===Q.Ot(t)?this.l.error("Device Metadata must be valid"):(this.oi||(this.oi=new ut.Impl.Html5Metadata),t[A.DeviceMetadata.BRAND]&&(this.oi.getDeviceBrand=function(){return t[A.DeviceMetadata.BRAND]}),t[A.DeviceMetadata.MANUFACTURER]&&(this.oi.getDeviceManufacturer=function(){return t[A.DeviceMetadata.MANUFACTURER]}),t[A.DeviceMetadata.MODEL]&&(this.oi.getDeviceModel=function(){return t[A.DeviceMetadata.MODEL]}),t[A.DeviceMetadata.TYPE]&&(this.oi.getDeviceType=function(){return t[A.DeviceMetadata.TYPE]}),t[A.DeviceMetadata.VERSION]&&(this.oi.getDeviceVersion=function(){return t[A.DeviceMetadata.VERSION]}),t[A.DeviceMetadata.OS_NAME]&&(this.oi.getOperatingSystemName=function(){return t[A.DeviceMetadata.OS_NAME]}),t[A.DeviceMetadata.OS_VERSION]&&(this.oi.getOperatingSystemVersion=function(){return t[A.DeviceMetadata.OS_VERSION]}),t[A.DeviceMetadata.CATEGORY]&&(this.oi.getDeviceCategory=function(){return t[A.DeviceMetadata.CATEGORY]}),n=t[A.DeviceMetadata.SCREEN_RESOLUTION_WIDTH],Q.dt(n)&&(this.oi.getScreenWidth=function(){return n.toString()}),i=t[A.DeviceMetadata.SCREEN_RESOLUTION_HEIGHT],Q.dt(i)&&(this.oi.getScreenHeight=function(){return i.toString()}),e=t[A.DeviceMetadata.SCREEN_RESOLUTION_SCALE_FACTOR],Q.dt(e)&&(this.oi.getScaleFactor=function(){return e.toString()}))},reportDeviceMetric:function(t,n){switch(this.le||(this.le={}),t){case A.Network.CONNECTION_TYPE:if(!Q.At(n))return void this.l.error("reportDeviceMetric() : Connection Type is not a valid string");this.le[t]=n,this.Gi&&this.Gi.W(this.le[A.Network.CONNECTION_TYPE]);break;case A.Network.LINK_ENCRYPTION:if(!Q.At(n))return void this.l.error("reportDeviceMetric() : Link Encryption is not a valid string");this.le[t]=n,this.Gi&&this.Gi.J(this.le[A.Network.LINK_ENCRYPTION]);break;case A.Network.SIGNAL_STRENGTH:var i=parseInt(n,10);if(!Q.dt(i))return void this.l.error("reportDeviceMetric() : Signal Strength is not a number");if(a.DEFAULT_SIGNAL_STRENGTH===i)return void this.l.error("reportDeviceMetric() : DEFAULT_SIGNAL_STRENGTH shouldn't be reported");this.le[t]=i,this.Gi&&this.Gi.Q(i);break;default:this.l.error("reportDeviceMetric() : unknown device metric = "+t)}}};S.version="4.5.4";var R=at.AnalyticsImpl=function(){var h=this;function c(){var t=!!h.ki,n=h.getAdType(),i=h.ne();return n===A.AdType.SERVER_SIDE&&i===A.AdPlayer.CONTENT?R.pe.Ee:n!==A.AdType.SERVER_SIDE||i!==A.AdPlayer.SEPARATE?n===A.AdType.CLIENT_SIDE&&i===A.AdPlayer.CONTENT?R.pe.ge:(n===A.AdType.CLIENT_SIDE&&A.AdPlayer.SEPARATE,t?R.pe.ge:R.pe.ye):void 0}function f(t,n,i){t=parseInt(t,10),n=parseInt(n,10);isNaN(t)&&isNaN(n)?h.l.error("reportPlaybackResolution() : width and height are not numbers"):(isNaN(t)&&h.l.warning("reportPlaybackResolution() : width is not a number"),isNaN(n)&&h.l.warning("reportPlaybackResolution() : height is not a number"),!h.ki||i!==R.pe.ge&&i!==R.pe.Ee||h.ki.Ae(t,n),!h.Bi||i!==R.pe.ye&&i!==R.pe.Ee||h.Bi.Ae(t,n))}function l(t,n){a.Kn(t)?(!h.ki||n!==R.pe.ge&&n!==R.pe.Ee||h.ki.Se(t),(h.Bi&&n===R.pe.ye||n===R.pe.Ee)&&h.Bi.Se(t)):h.l.error("reportPlayerState() : Player State is not valid")}function d(t,n){t=parseInt(t,10);isNaN(t)?h.l.error("reportPlayerPlayHeadTime() : playheadtime is not a number"):(!h.ki||n!==R.pe.ge&&n!==R.pe.Ee||h.ki.Re(t),!h.Bi||n!==R.pe.ye&&n!==R.pe.Ee||h.Bi.Re(t))}function v(t,n){t=parseInt(t,10);isNaN(t)?h.l.error("reportPlayerBufferLength() : buffer length is not a number"):(!h.ki||n!==R.pe.ge&&n!==R.pe.Ee||h.ki.me(t),!h.Bi||n!==R.pe.ye&&n!==R.pe.Ee||h.Bi.me(t))}function E(t,n){t=parseInt(t,10);!h.ki||n!==R.pe.ge&&n!==R.pe.Ee||h.ki.Ce(!0,t),!h.Bi||n!==R.pe.ye&&n!==R.pe.Ee||h.Bi.Ce(!0,t)}function p(t){!h.ki||t!==R.pe.ge&&t!==R.pe.Ee||h.ki.Ce(!1,-1),!h.Bi||t!==R.pe.ye&&t!==R.pe.Ee||h.Bi.Ce(!1,-1)}function g(t,n){t=parseInt(t,10);isNaN(t)?h.l.error("reportPlayerBitrate() : bitrate is not a number"):(!h.ki||n!==R.pe.ge&&n!==R.pe.Ee||h.ki.Te(t),!h.Bi||n!==R.pe.ye&&n!==R.pe.Ee||h.Bi.Te(t))}function y(t,n){t=parseInt(t,10);isNaN(t)?h.l.error("reportPlayerRenderedFrameRate() : rendered framerate is not a number"):(!h.ki||n!==R.pe.ge&&n!==R.pe.Ee||h.ki.Ie(t),!h.Bi||n!==R.pe.ye&&n!==R.pe.Ee||h.Bi.Ie(t))}(function(){}).apply(this,arguments),this.Ji=function(t,n,i,e){switch(h.l&&t!==A.Playback.PLAY_HEAD_TIME&&t!==A.Playback.BUFFER_LENGTH&&h.l.debug("reportMetric() "+t+" "+(void 0!==n&&"CONVIVA"!==n?n:"")+" "+(void 0!==i&&"CONVIVA"!==i&&i!==R.pe.ge?i:"")+" "+(void 0!==e&&"CONVIVA"!==e&&e!==R.pe.ge?e:"")),t){case A.Playback.BITRATE:"CONVIVA"===i?h.l.info("Bitrate change requested from the Conviva Library:"):h.l.info("Bitrate change requested from the application:"),e===R.pe.ge?g(n,R.pe.ge):g(n,c());break;case A.Playback.PLAY_HEAD_TIME:e===R.pe.ge?d(n,R.pe.ge):d(n,c());break;case A.Playback.RESOLUTION:e===R.pe.ge?f(n,i,R.pe.ge):f(n,i,c());break;case A.Playback.BUFFER_LENGTH:e===R.pe.ge?v(n,R.pe.ge):v(n,c());break;case A.Playback.PLAYER_STATE:e===R.pe.ge?l(n,R.pe.ge):l(n,c());break;case A.Playback.RENDERED_FRAMERATE:e===R.pe.ge?y(n,R.pe.ge):y(n,c());break;case A.Playback.SEEK_STARTED:arguments.length>=2&&"CONVIVA"!==n?E(n,c()):i===R.pe.ge?E(-1,R.pe.ge):E(-1,c());break;case A.Playback.SEEK_ENDED:i===R.pe.ge?p(R.pe.ge):p(c());break;case A.Playback.CDN_IP:"CONVIVA"===i?h.l.info("CDN Server IP change requested from the Conviva Library:"):h.l.info("CDN Server IP change requested from the application:"),a=n,u=c(),Q.At(a)?(!h.ki||u!==R.pe.ge&&u!==R.pe.Ee||h.ki.we(a),!h.Bi||u!==R.pe.ye&&u!==R.pe.Ee||h.Bi.we(a)):h.l.error("reportCDNServerIp() : CDNServerIP is not a valid string");break;case A.Playback.DROPPED_FRAMES_TOTAL:"CONVIVA"===i?h.l.info("Dropped frames total change requested from the Conviva Library:"):h.l.info("Dropped frames total change requested from the application:"),r=n,a=c(),r=parseInt(r,10),isNaN(r)?h.l.error("reportDroppedFramesTotal() : Dropped frames total is not a number"):(!h.ki||a!==R.pe.ge&&a!==R.pe.Ee||h.ki.Ne(r),!h.Bi||a!==R.pe.ye&&a!==R.pe.Ee||h.Bi.Ne(r));break;case A.Playback.DROPPED_FRAMES_COUNT:"CONVIVA"===i?h.l.info("Dropped frames count change requested from the Conviva Library:"):h.l.info("Dropped frames count change requested from the application:"),s=n,o=c(),s=parseInt(s,10),isNaN(s)?h.l.error("reportDroppedFramesTotal() : Dropped frames total is not a number"):(!h.ki||o!==R.pe.ge&&o!==R.pe.Ee||h.ki.Oe(s),!h.Bi||o!==R.pe.ye&&o!==R.pe.Ee||h.Bi.Oe(s));break;default:r=t,o=n,s=c(),!(Q.At(r)&&o?(!h.ki||s!==R.pe.ge&&s!==R.pe.Ee||h.ki.Bt(r,o),void(!h.Bi||s!==R.pe.ye&&s!==R.pe.Ee||h.Bi.Bt(r,o))):h.l.error("reportMetric() : Metric key/value should be a proper value"))}var s,o,r,a,u}};at.AnalyticsImpl.pe={ge:1,ye:2,Ee:3};var e=at.PlayerMonitor=function(){var e=this;this._e=null,this.Pe=null,this.pt=null,this.De=null,this.vn=a.PlayerState.UNKNOWN,this.be=-1,this.Me=-1,this.Tn=[],this.Le=null,this.Ve=null,this.ke=-2,this.pn=-1,this.O=a.DEFAULT_SIGNAL_STRENGTH,this.Ue=null,this.zn=null,this.N=null,this.w=null,this.Ki=null,this.Fe=null,this.Be=null,this.He=null,this.Ge=null,this.Zi=null,this.ji=null,function(t){e.Ki=t}.apply(this,arguments),this.Ke=function(){return e.vn},this.Se=function(t){e.vn!==t&&(e.oe(),e.vn=t,e.je())},this.xe=function(){return e.We},this.qe=function(){return e.Ye},this.Ce=function(t,n){e.oe(),e.We=t,e.Ye=n,e.Je()},this.Xe=function(){return e.be},this.Re=function(t){e.be=t},this.Qe=function(){return e.Me},this.me=function(t){e.Me=t},this.ze=function(){return e.ke},this.Te=function(t){e.ke!==t&&(e.ke=t,e.je())},this.Ze=function(){return e.pn},this.Ie=function(t){e.pn=t},this.$e=function(){return e.Ue},this.we=function(t){e.Ue=t,e.je()},this.Qn=function(){return e.zn},this.Ne=function(t){e.zn=t,e.je()},this.Oe=function(t){e.ts(t)},this.ns=function(){return e.O},this.es=function(){return e.ss},this.os=function(){return e.rs},this.Ae=function(t,n){t<0&&(t=0),n<0&&(n=0),e.ss===t&&e.rs===n||(e.ss=t,e.rs=n,e.je())},this.as=function(){return e.Pe},this.us=function(){e.as()&&(e.pt=new f,e.De={},e.Be={},e.hs())},this.cs=function(t){(e.Pe||t)&&(this.oe(),e.Pe&&(e.Pe=null,e.us()),t&&(e.Pe=Q.fs(e.Pe,t),e.us()))},this.Yi=function(t){if(t)if(e.pt){var n,i=!1;for(n in t)if(e.pt[n]!==t[n]){i=!0;break}i&&(e.oe(),e.Pe=Q.fs(t),e.hs())}else e.cs(t)},this.Xi=function(t){t?e.He!==t&&(e.He=t,e.ls()):(e.He=null,e.fe())},this.oe=function(){e.ds||e.He&&(e.ds=!0,e.He(),e.ds=!1)},this.Ui=function(){return e._e},this.Hi=function(t,n){e._e!==t&&(e.oe(),e._e&&(e.vs(),e.fe(),e.zi()),e._e=t,e._e&&e.re(n))},this.Es=function(){return e.Le},this.ps=function(){return e.Ve||null},this.gs=function(){return e.Tn},this.ys=function(){e.Tn=[]},this.Gn=function(t){this.oe(),e.Tn.push(t),e.Jn()},this.Qi=function(t,n){e.oe(),e.Le=t,e.Ve=n,e.As()},this.Ss=function(){e.oe()},this.ls=function(){e.fe(),e.Fe=e.Ki.create(e.Ss,1e3,"PlayerMonitor.update")},this.fe=function(){e.Fe&&(e.Fe(),e.Fe=null)},this.$i=function(t,n,i){e.Ge=i,e.Zi=t,e.Rs(),e.ji=n,e.Zi&&A.AdType.CLIENT_SIDE===e.Zi&&(e.vn=A.PlayerState.UNKNOWN,e.ms(e.Zi,n,i?i[A.POD_POSITION]:null))},this.te=function(){e.Zi&&A.AdType.CLIENT_SIDE===e.Zi&&(e.Cs(),e.vn=A.PlayerState.UNKNOWN),e.Ts(),e.Zi=null,e.ji=null},this.Is=function(){return e.Ge},this.ws=function(){return e.Zi},this.getContentMetadata=function(){return this.pt},this.zi=function(){this._e=null,this.Pe=null,this.pt=null,this.De=null,this.vn=a.PlayerState.UNKNOWN,this.be=-1,this.Me=-1,this.Tn=[],this.Le=null,this.Ve=null,this.ke=-2,this.pn=-1,this.O=a.DEFAULT_SIGNAL_STRENGTH,this.Ue=null,this.zn=null,this.N=null,this.w=null,this.Ki=null,this.Fe=null,this.Be=null,this.He=null,this.Ge=null,this.Zi=null,this.ji=null,e.ae=null,e.ce=h.NO_SESSION_KEY}},m=at.PlayerMonitorImpl=function(){var r=this;r.ie=null,r.ae=null,r.ce=h.NO_SESSION_KEY,function(t,n){e.call(this,n),r.ie=t}.apply(this,arguments),this.getPHT=function(){return r.Xe()},this.getBufferLength=function(){return r.Qe()},this.getRenderedFrameRate=function(){return r.Ze()},this.getSignalStrength=function(){return r.ns()},this.Je=function(){r.ae&&r.Ns!==h.NO_SESSION_KEY&&(r.xe()?r.ae.setPlayerSeekStart(r.qe()):r.ae.setPlayerSeekEnd())},this.je=function(){r.ae&&(r.ae.setPlayerState(r.Ke()),r.ze()>0&&r.ae.setBitrateKbps(r.ze()),r.es()>0&&r.ae.setVideoResolutionWidth(r.es()),r.os()>0&&r.ae.setVideoResolutionHeight(r.os()),r.$e()&&r.ae.setCDNServerIP(r.$e()),Q.dt(r.Qn())&&r.ae.setDroppedFramesTotal(r.Qn()))},this.Rt=function(){r.ce!==h.NO_SESSION_KEY&&r.ie&&r.ie.updateContentMetadata(r.ce,r.pt)},this.ue=function(){if(r.ae){var t,n,i;r.Be&&Q.Ot(r.Be)>0&&(r.Be[A.MODULE_NAME]&&r.Be[A.MODULE_VERSION]&&(t=r.Be[A.MODULE_NAME],n=r.Be[A.MODULE_VERSION],Q.At(t)&&Q.At(n)&&r.ae.setModuleNameAndVersion(t,n)),r.Be[A.FRAMEWORK_NAME]&&(i=r.Be[A.FRAMEWORK_NAME],Q.At(i)&&r.ae.setPlayerType(i)),r.Be[A.FRAMEWORK_VERSION]&&(i=r.Be[A.FRAMEWORK_VERSION],Q.At(i)&&r.ae.setPlayerVersion(i)));var e=r.gs();r.ys();for(var s=0;s<e.length;s++){var o=e[s];r.ae.Gn(o)}}},this.Cs=function(){r.ae&&r.ce!==h.NO_SESSION_KEY&&(r.je(),this.Os())},this.Tt=function(){r.ae&&r.ce!==h.NO_SESSION_KEY&&(r.je(),r.ie.It(r.ce))},this.Os=function(){r.ie&&r.ce!==A.NO_SESSION_KEY&&r.ie.adEnd(r.ce)},this.ms=function(t,n,i){var e;r.ae&&r.ce!==A.NO_SESSION_KEY&&(e=null,A.AdType.CLIENT_SIDE===t?e=h.AdStream.SEPARATE:A.AdType.SERVER_SIDE===t&&(e=h.AdStream.CONTENT),r._s(e,n,i))},this.mt=function(){r.ae&&r.ce!==A.NO_SESSION_KEY&&r.ie.Ct(r.ce)},this._s=function(t,n,i){r.ie&&r.ce!==A.NO_SESSION_KEY&&r.ie.adStart(r.ce,t,n,i)},this.re=function(){if(r.ie){r.ae=r.ie.getPlayerStateManager(!0),r.ue(),r.ae.setClientMeasureInterface(this);try{var t;r.pt&&r.pt.custom&&!r.pt.custom[A.UTM_TRACKING_URL]&&(Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||null===this)throw new TypeError;var n=Object(this),i=n.length>>>0;if("function"!==typeof t)throw new TypeError;for(var e,s=[],o=arguments.length>=2?arguments[1]:void 0,r=0;r<i;r++)r in n&&(e=n[r],t.call(o,e,r,n)&&s.push(e));return s}),""!==(t=Q.Ps().split("?").join("").split("&").filter(function(t){return 2===t.split("=").length&&t.split("=")[0].toLowerCase().indexOf("utm_")>=0}).join("&"))&&(r.pt.custom[A.UTM_TRACKING_URL]=t))}catch(t){r.l.error("PlayerMonitorImpl _createSession : "+t)}r.ce=r.ie.createSession(r.pt,r.ae,!0)}},this.vs=function(){r.ie&&(r.ae&&(r.ae.setPlayerState(A.PlayerState.STOPPED),r.ae=null),r.ce!==A.NO_SESSION_KEY&&(r.ie.cleanupSession(r.ce),r.ce=A.NO_SESSION_KEY))},this.Jn=function(){if(r.ie&&r.ce!==h.NO_SESSION_KEY){var t=r.gs();r.ys();for(var n=0;n<t.length;n++){var i=t[n];r.ie.reportError(r.ce,i.Ds(),i.bs())}}},this.As=function(){r.ce!==h.NO_SESSION_KEY&&r.ie&&r.ie.sendCustomEvent(r.ce,r.Es(),r.ps())},this.hs=function(){var t,n=r.as(),i=!1,e=!1;for(t in n){var s=n[t];if(Q.At(t)&&null!==s&&void 0!==s)switch(t){case A.STREAM_URL:e=!0,r.pt.streamUrl=s;break;case A.ASSET_NAME:e=!0,r.pt.assetName=s;break;case A.DEFAULT_RESOURCE:e=!0,r.pt.defaultResource=s;break;case A.VIEWER_ID:e=!0,r.pt.viewerId=s;break;case A.PLAYER_NAME:e=!0,r.pt.applicationName=s;break;case A.DURATION:e=!0,r.pt.duration=s;break;case A.IS_LIVE:e=!0,r.pt.streamType=s;break;case A.ENCODED_FRAMERATE:e=!0,r.pt.encodedFrameRate=s;break;case A.MODULE_NAME:case A.MODULE_VERSION:case A.FRAMEWORK_NAME:case A.FRAMEWORK_VERSION:i=!0,r.Be[t]=s;break;case A.APPLICATION_VERSION:default:e=!0,r.pt.custom[t]=s}}i&&this.ue(),e&&this.Rt()},this.Rs=function(){this.Ms(A.Events.POD_START)},this.Ts=function(){this.Ms(A.Events.POD_END)},this.Ms=function(t){var n,i,e,s;r.ie&&r.ce!==A.NO_SESSION_KEY&&(i={},(n=this.Is())&&((e=n[A.POD_POSITION])&&(i[A.POD_POSITION]=e),(e=n[A.POD_INDEX])&&(i[A.POD_INDEX]=e+""),t!==A.Events.POD_START||(s=n[A.POD_DURATION])&&(i[A.POD_DURATION]=s+"")),(s=this.ws())&&(i[A.AD_TYPE]=s),r.ie.sendCustomEvent(r.ce,t,i))},this.ts=function(t){r.ae.setDroppedFramesCount(t)},this.Ls=function(t){this.ce===A.NO_SESSION_KEY&&t!==A.NO_SESSION_KEY&&(this.ce=t)},this.he=function(){return this.ce},this.Ut=function(){return r.ie.getSessionId(this.ce)},this.Ft=function(){return r.ie.getClientId(this.ce)},this.Bt=function(t,n){r.ie.Bt(this.ce,t,n)},m.prototype=Object.create(e.prototype),m.prototype.constructor=m};ut.Impl=ut.Impl||{},ut.Impl.Html5Http=function(){(function(){}).apply(this,arguments),this.makeRequest=function(){return this.makeRequestStandard.apply(this,arguments)},this.makeRequestStandard=function(t,n,i,e,s,o){var r=new XMLHttpRequest;return r.open(t,n,!0),e&&r.overrideMimeType&&(r.overrideMimeType=e),e&&r.setRequestHeader&&r.setRequestHeader("Content-Type",e),s>0&&(r.timeout=s,r.ontimeout=function(){r.ontimeout=r.onreadystatechange=null,o&&o(!1,"timeout after "+s+" ms")}),r.onreadystatechange=function(){4===r.readyState&&(r.ontimeout=r.onreadystatechange=null,200===r.status?o&&o(!0,r.responseText):o&&o(!1,"http status "+r.status))},r.send(i),null},this.release=function(){}},ut.Impl=ut.Impl||{},ut.Impl.Html5Logging=function(){(function(){}).apply(this,arguments),this.consoleLog=function(t,n){"undefined"!==typeof console&&(console.log&&n===y.LogLevel.DEBUG||n===y.LogLevel.INFO?console.log(t):console.warn&&n===y.LogLevel.WARNING?console.warn(t):console.error&&n===y.LogLevel.ERROR&&console.error(t))},this.release=function(){}},ut.Impl=ut.Impl||{},ut.Impl.Html5Metadata=function(){(function(){}).apply(this,arguments),this.getBrowserName=function(){return null},this.getBrowserVersion=function(){return null},this.getDeviceBrand=function(){return null},this.getDeviceManufacturer=function(){return null},this.getDeviceModel=function(){return null},this.getDeviceType=function(){return null},this.getDeviceVersion=function(){return null},this.getFrameworkName=function(){return null},this.getFrameworkVersion=function(){return null},this.getOperatingSystemName=function(){return null},this.getOperatingSystemVersion=function(){return null},this.getDeviceCategory=function(){return null},this.getScreenWidth=function(){return"undefined"!==typeof window&&window&&window.screen&&window.screen.width?window.screen.width.toString():null},this.getScreenHeight=function(){return"undefined"!==typeof window&&window&&window.screen&&window.screen.height?window.screen.height.toString():null},this.getScaleFactor=function(){return"undefined"!==typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio.toString():null},this.release=function(){}},ut.Impl=ut.Impl||{},ut.Impl.Html5Storage=function(){(function(){}).apply(this,arguments),this.saveData=function(t,n,i,e){var s=t+"."+n;try{localStorage.setItem(s,i),e(!0,null)}catch(t){e(!1,t.toString())}},this.loadData=function(t,n,i){var e=t+"."+n;try{i(!0,localStorage.getItem(e))}catch(t){i(!1,t.toString())}},this.release=function(){}},ut.Impl=ut.Impl||{},ut.Impl.Html5Time=function(){(function(){}).apply(this,arguments),this.getEpochTimeMs=function(){return(new Date).getTime()},this.release=function(){}},ut.Impl=ut.Impl||{},ut.Impl.Html5Timer=function(){(function(){}).apply(this,arguments),this.createTimer=function(t,n){var i=setInterval(t,n);return function(){-1!==i&&(clearInterval(i),i=-1)}},this.release=function(){}};var n,s,C,T,I,w=at.VideoAnalytics=function(){var s=this;s.Gi=null,s.l=null,s.v=null,s.Ki=null,s.Bi=null,s.xi=null,this.release=function(){s.l&&s.l.debug("VideoAnalytics.release()"),s.Bi&&s.Bi.Ui()&&s.Bi.Hi(!1),"undefined"!==typeof ut.ProxyMonitor&&s.xi&&(ut.ProxyMonitor.release(s.xi),s.xi=null),s.Bi&&(s.Bi.Xi(null),s.Bi.zi(),s.Bi=null),s.Ki=null},function(t,n){s.Gi=t,s.v=n,s.Ki=n.buildTimer(A.version),s.l=n.buildLogger(),s.l.setModuleName("VideoAnalytics"),s.Bi=new m(s.Gi,s.Ki),R.call(this)}.apply(this,arguments),this.reportPlaybackRequested=function(t){s.l&&s.l.debug("VideoAnalytics.reportPlaybackRequested()"),s.Bi?(Q.Ot(t)>0&&s.setContentInfo(t),s.Bi.Ui()||s.Bi.Hi(!0)):s.l.error("VideoAnalytics.reportPlaybackRequested() : "+A.u)},this.reportPlaybackEnded=function(){s.l&&s.l.debug("VideoAnalytics.reportPlaybackEnded()"),s.Bi?s.Bi.Ui()&&(s.Bi.Hi(!1),"undefined"!==typeof ut.ProxyMonitor&&s.xi&&(ut.ProxyMonitor.release(s.xi),s.xi=null),s.Bi.Xi(null)):s.l.error("VideoAnalytics.reportPlaybackEnded() : "+A.u)},this.reportPlaybackFailed=function(t,n){s.Bi?(Q.Ot(n)>0&&s.setContentInfo(n),s.Bi.Ui()||s.Bi.Hi(!0),s.l&&s.l.debug("VideoAnalytics.reportPlaybackFailed()"),s.reportPlaybackError(t,h.ErrorSeverity.FATAL),s.reportPlaybackEnded()):s.l.error("VideoAnalytics.reportPlaybackFailed() : "+A.e)},this.setContentInfo=function(t){Q.Ot(t)<=0?s.l.error("VideoAnalytics.setContentInfo() : Content Info is not set"):s.Bi?(s.l&&s.l.debug("VideoAnalytics.setContentInfo()"),s.Bi.Yi(t)):s.l.error("VideoAnalytics.setContentInfo() : "+A.e)},this.setPlayerInfo=function(t){Q.Ot(t)<=0?s.l.error("VideoAnalytics.setPlayerInfo() : Player Info is not set"):s.Bi?(s.l&&s.l.debug("VideoAnalytics.setPlayerInfo()"),s.Bi.Yi(t)):s.l.error("VideoAnalytics.setPlayerInfo() : "+A.e)},this.reportPlaybackMetric=function(){0!==arguments.length?1===arguments.length?s.Ji(arguments[0]):2===arguments.length?s.Ji(arguments[0],arguments[1]):3===arguments.length?s.Ji(arguments[0],arguments[1],arguments[2]):4===arguments.length&&s.Ji(arguments[0],arguments[1],arguments[2],arguments[3]):s.l.error("VideoAnalytics.reportPlaybackMetric() : Need to report metric mandatory")},this.reportPlaybackError=function(t,n){s.Bi?Q.At(t)?(s.l&&s.l.debug("VideoAnalytics.reportPlaybackError()"),n=new nt(t,n),s.Bi.Gn(n)):s.l.error("VideoAnalytics.reportPlaybackError() : errorMessage need to be valid string"):s.l.error("VideoAnalytics.reportPlaybackError() : "+A.e)},this.reportPlaybackEvent=function(t,n){if(Q.At(t))if(s.Bi){if(s.l&&s.l.debug("VideoAnalytics.reportPlaybackEvent()"),s.Bi)switch(t){case A.Events.USER_WAIT_STARTED:case A.Events.BUMPER_VIDEO_STARTED:s.Bi.mt();break;case A.Events.USER_WAIT_ENDED:case A.Events.BUMPER_VIDEO_ENDED:s.Bi.Tt();break;default:s.Bi.Qi(t,n)}}else s.l.error("VideoAnalytics.reportPlaybackEvent() : "+A.e);else s.l.error("VideoAnalytics.reportPlaybackEvent(): eventType parameter must be a valid string.")},this.setCallback=function(t){s.l&&s.l.debug("setCallback()"),s.Bi&&s.Bi.Xi(t)},this.reportAdBreakStarted=function(t,n,i){s.Bi?(s.l&&s.l.debug("VideoAnalytics.reportAdBreakStarted()"),s.Bi.$i(t,n,i)):s.l.error("VideoAnalytics.reportAdBreakStarted() : "+A.e)},this.reportAdBreakEnded=function(){s.Bi?(s.l&&s.l.debug("VideoAnalytics.reportAdBreakEnded()"),s.Bi.te()):s.l.error("VideoAnalytics.reportAdBreakEnded() : "+A.e)},this.setPlayer=function(t,n){var i,e;void 0!==t?(n&&(i=n[A.CONVIVA_MODULE],e=n[A.MEDIA_ELEMENT]),"undefined"!==typeof i?ut.ProxyMonitor=i.ProxyMonitor:"undefined"!==typeof ConvivaModule&&(ut.ProxyMonitor=ConvivaModule.ProxyMonitor),"undefined"!==typeof ut.ProxyMonitor?(s.l&&s.l.debug("VideoAnalytics.setPlayer()"),!t&&s.xi?(ut.ProxyMonitor.release(s.xi),s.xi=null):t?(s.xi&&ut.ProxyMonitor.release(s.xi),s.l&&s.l.debug("VideoAnalytics.setPlayer() : Initializing drop-in module"),s.xi="undefined"!==typeof e?ut.ProxyMonitor.initConvivaDropIn(t,e,s.v,this,ut):ut.ProxyMonitor.initConvivaDropIn(t,s.v,this,ut)):t||"undefined"===typeof e||(s.xi=ut.ProxyMonitor.initConvivaDropIn(t,e,s.v,this,ut))):s.l.error("VideoAnalytics.setPlayer() : Include the missing Player Module")):s.l.error("VideoAnalytics.setPlayer() : Need to configure the Player")},this.setAdAnalytics=function(t){t?s.getAdType()&&(s.getAdType()===A.AdType.SERVER_SIDE?s.ki=t.getAdPlayerMonitor():s.getAdType()===A.AdType.CLIENT_SIDE&&s.l&&s.l.error("VideoAnalytics.setAdAnalytics() : API is not meant for Client Side Ads")):s.ki=null},this.configureExistingSession=function(t){t!==A.NO_SESSION_KEY?s.Bi?(s.l&&s.l.debug("VideoAnalytics.configureExistingSession()"),s.Bi.Ls(t)):s.l.error("VideoAnalytics.configureExistingSession() : "+A.e):s.l.error("VideoAnalytics.configureExistingSession() : Invalid Session Key")},this.getSessionId=function(){return s.Bi?(s.l&&s.l.debug("VideoAnalytics.getSessionId()"),s.Bi.Ut()):(s.l.error("VideoAnalytics.getSessionId() : "+A.e),A.NO_SESSION_KEY)},this.getClientId=function(){return s.Bi?(s.l&&s.l.debug("VideoAnalytics.getClientId()"),s.Bi.Ft()):(s.l.error("VideoAnalytics.getClientId() : "+A.e),null)},this.qi=function(){return s.l&&s.l.debug("VideoAnalytics.getPlayerMonitor()"),this.Bi},this.getAdType=function(){return s.Bi?s.Bi.Zi:null},this.ne=function(){return s.Bi?s.Bi.ji:null},w.prototype=Object.create(R.prototype),w.prototype.constructor=w};function N(t){throw{name:"SyntaxError",message:t,at:n,text:C}}function O(t){return t&&t!==s&&N("Expected '"+t+"' instead of '"+s+"'"),s=C.charAt(n),n+=1,s}function t(){var t,n="";for("-"===s&&O(n="-");s>="0"&&s<="9";)n+=s,O();if("."===s)for(n+=".";O()&&s>="0"&&s<="9";)n+=s;if("e"===s||"E"===s)for(n+=s,O(),"-"!==s&&"+"!==s||(n+=s,O());s>="0"&&s<="9";)n+=s,O();if(t=+n,!isNaN(t))return t;N("Bad number")}function _(){var t,n,i,e="";if('"'===s)for(;O();){if('"'===s)return O(),e;if("\\"===s)if(O(),"u"===s){for(n=i=0;n<4&&(t=parseInt(O(),16),isFinite(t));n+=1)i=16*i+t;e+=String.fromCharCode(i)}else{if("string"!==typeof T[s])break;e+=T[s]}else e+=s}N("Bad string")}function P(){for(;s&&s<=" ";)O()}at.JsonParse=(T={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},I=function(){switch(P(),s){case"{":return function(){var t,n={};if("{"===s){if(O("{"),P(),"}"===s)return O("}"),n;for(;s;){if(t=_(),P(),O(":"),Object.hasOwnProperty.call(n,t)&&N('Duplicate key "'+t+'"'),n[t]=I(),P(),"}"===s)return O("}"),n;O(","),P()}}N("Bad object")}();case"[":return function(){var t=[];if("["===s){if(O("["),P(),"]"===s)return O("]"),t;for(;s;){if(t.push(I()),P(),"]"===s)return O("]"),t;O(","),P()}}N("Bad array")}();case'"':return _();case"-":return t();default:return(s>="0"&&s<="9"?t:function(){switch(s){case"t":return O("t"),O("r"),O("u"),O("e"),!0;case"f":return O("f"),O("a"),O("l"),O("s"),O("e"),!1;case"n":return O("n"),O("u"),O("l"),O("l"),null}N("Unexpected '"+s+"'")})()}},function(t,r){return C=t,n=0,s=" ",t=I(),P(),s&&N("Syntax error"),"function"===typeof r?function t(n,i){var e,s,o=n[i];if(o&&"object"===typeof o)for(e in o)Object.hasOwnProperty.call(o,e)&&(void 0!==(s=t(o,e))?o[e]=s:delete o[e]);return r.call(n,i,o)}({"":t},""):t});var D,b,M,L,V,k=at.JSON2={};function U(t){return t<10?"0"+t:t}function F(t){return D.lastIndex=0,D.test(t)?'"'+t.replace(D,function(t){var n=L[t];return"string"===typeof n?n:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+U(this.getUTCMonth()+1)+"-"+U(this.getUTCDate())+"T"+U(this.getUTCHours())+":"+U(this.getUTCMinutes())+":"+U(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!==typeof k.stringify&&(D=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,L={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k.stringify=function(t,n,i){var e;if(M=b="","number"===typeof i)for(e=0;e<i;e+=1)M+=" ";else"string"===typeof i&&(M=i);if((V=n)&&"function"!==typeof n&&("object"!==typeof n||"number"!==typeof n.length))throw new Error("JSON2.stringify");return function t(n,i){var e,s,o,r,a,u=b,h=i[n];switch(h&&"object"===typeof h&&"function"===typeof h.toJSON&&(h=h.toJSON(n)),"function"===typeof V&&(h=V.call(i,n,h)),typeof h){case"string":return F(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(b+=M,a=[],Object.prototype.toString.apply(h)===Object.prototype.toString.apply([])){for(r=h.length,e=0;e<r;e+=1)a[e]=t(e,h)||"null";return o=0===a.length?"[]":b?"[\n"+b+a.join(",\n"+b)+"\n"+u+"]":"["+a.join(",")+"]",b=u,o}if(V&&"object"===typeof V)for(r=V.length,e=0;e<r;e+=1)"string"===typeof V[e]&&(o=t(s=V[e],h))&&a.push(F(s)+(b?": ":":")+o);else for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(o=t(s,h))&&a.push(F(s)+(b?": ":":")+o);return o=0===a.length?"{}":b?"{\n"+b+a.join(",\n"+b)+"\n"+u+"}":"{"+a.join(",")+"}",b=u,o}}("",{"":t})});var B=at.CwsProtocol=function(){this.Vs=function(t,n,i,e){return e.seq=t,e.st=n,e.t=i,e},this.ks=function(t,n){var i=B.Us;return this.Vs(t,n,i,{})}};B.version="2.6",B.Fs="/0/wsg",B.M="0",B.Bs=!1,B.Hs=2,B.Gs=-1,B.Ks=-1,B.js=1e3,B.xs="sdk.js.1",B.Ws="CwsStateChangeEvent",B.qs="CwsErrorEvent",B.Us="CwsSessionEndEvent",B.Ys="CwsCustomEvent",B.Js="CwsSeekEvent",B.Xs="CwsDataSamplesEvent",B.Qs="ok",B.zs="err",B.Zs="clid",B.$s="cfg",B.no="evs",B.io="maxhbinfos",B.eo="slg",B.so="hbi",B.oo="gw",B.ro="fp",B.ao="csi_en",B.uo="CwsSessionHb",B.ho="t",B.co="st",B.fo="sst",B.lo="lv",B.do="seq",B.vo="cid",B.Eo="clid",B.po="clv",B.go="pver",B.yo="iid",B.Ao="sid",B.So="vid",B.Ro="an",B.mo="pn",B.Co="tags",B.To="sf",B.Io="evs",B.wo="lg",B.No="hbinfos",B.Oo="sdk",B._o="pj",B.Po="ps",B.Do="br",B.bo="cl",B.Mo="efps",B.Lo="afps",B.Vo="rfpstot",B.ko="rfpscnt",B.Uo="rs",B.Fo="pht",B.Bo="bl",B.Ho="url",B.Go="caps",B.Ko="pm",B.jo="w",B.xo="h",B.Wo="ct",B.qo="le",B.Yo="dftot",B.Jo="dfcnt",B.Xo="ss",B.Qo="csi_n",B.zo="csi_t",B.Zo="csi_l",B.$o="csi_v",B.tr="csi_c",B.nr="sch",B.ir="br",B.er="brv",B.sr="dvb",B.or="dvma",B.rr="dvm",B.ar="dvt",B.ur="dvv",B.hr="sw",B.cr="sh",B.fr="scf",B.lr="fw",B.dr="fwv",B.vr="cc",B.Er="mn",B.pr="mv",B.gr="os",B.yr="osv",B.Ar="cat",B.Sr="caps",B.Rr="t",B.mr="seq",B.Cr="st",B.Tr="act",B.Ir="skto",B.wr="err",B.Nr="ft",B.Or="new",B._r="old",B.Pr="name",B.Dr="attr",B.br="seq",B.Mr="err",B.Lr="rtt",B.Vr="ad",B.kr="csi",B.Ur=function(t){switch(t){case a.PlayerState.STOPPED:return B.Fr;case a.PlayerState.PLAYING:return B.Br;case a.PlayerState.BUFFERING:return B.Hr;case a.PlayerState.PAUSED:return B.Gr;case a.PlayerState.NOT_MONITORED:return B.Kr;default:return B.jr}},B.Fr=1,B.Br=3,B.Hr=6,B.Gr=12,B.Kr=98,B.jr=100,B.xr={Wr:0,ft:1,qr:2,Yr:4},B.Jr={Xr:0};var H=at.LibJSONInterface=function(){this.Qr=function(t){var n=null;try{n=k.stringify(t)}catch(t){return n}return n},this.zr=function(t){var n=null;try{n=at.JsonParse(t)}catch(t){return n}return Q.Zr(n)||(n=null),n}},G=at.CwsHeartbeat=function(){this.$r={},function(){}.apply(this,arguments),this.get=function(){return this.$r},this.ta=function(t,n){this.$r[t]=n},this.na=function(t,n,i){this.$r[t]||(this.$r[t]={}),this.$r[t][n]=i},this.ia=function(t){this.ta(B.ho,t)},this.ea=function(t){this.ta(B.co,t)},this.sa=function(t){this.ta(B.fo,t)},this.oa=function(t){this.ta(B.lo,t)},this.ra=function(t){this.ta(B.do,t)},this.aa=function(t){this.ta(B.vo,t)},this.ua=function(t){this.ta(B.Eo,t)},this.ha=function(t){this.ta(B.po,t)},this.ca=function(t){this.ta(B.go,t)},this.fa=function(t){this.ta(B.Sr,t)},this.Fn=function(t){this.ta(B.Ao,t)},this.la=function(t){this.ta(B.yo,t)},this.da=function(t){this.ta(B.So,t)},this.va=function(t){this.ta(B.Ro,t)},this.Ea=function(t){this.ta(B.mo,t)},this.pa=function(t){this.ta(B.Co,t)},this.ga=function(t){this.ta(B.To,t)},this.ya=function(t){this.ta(B.Go,t)},this.Aa=function(t){this.ta(B.Io,t)},this.Sa=function(t){this.ta(B.Oo,t)},this.Ra=function(t){this.ta(B.wo,t)},this.ma=function(t){this.ta(B.No,t)},this.Se=function(t){this.ta(B.Po,t)},this.Ca=function(t){this.ta(B._o,t)},this.Ta=function(t){this.ta(B.bo,t)},this.Ia=function(t){this.ta(B.Do,t)},this.wa=function(t){this.ta(B.Uo,t)},this.Na=function(t){this.ta(B.Mo,t)},this.Oa=function(t){this.ta(B.Lo,t)},this._a=function(t){this.ta(B.ko,t)},this.Pa=function(t){this.ta(B.Vo,t)},this.Da=function(t){this.na(B.Ko,B.nr,t)},this.ba=function(t){this.na(B.Ko,B.ir,t)},this.Ma=function(t){this.na(B.Ko,B.er,t)},this.La=function(t){this.na(B.Ko,B.sr,t)},this.Va=function(t){this.na(B.Ko,B.or,t)},this.ka=function(t){this.na(B.Ko,B.rr,t)},this.Ua=function(t){this.na(B.Ko,B.ar,t)},this.Fa=function(t){this.na(B.Ko,B.ur,t)},this.Ba=function(t){this.na(B.Ko,B.lr,t),this.ta(B.lr,t)},this.Ha=function(t){this.na(B.Ko,B.dr,t),this.ta(B.dr,t)},this.Ga=function(t){this.na(B.Ko,B.gr,t.toUpperCase())},this.Ka=function(t){this.na(B.Ko,B.yr,t)},this.ja=function(t){this.na(B.Ko,B.Ar,t)},this.xa=function(t){this.na(B.Ko,B.hr,t)},this.Wa=function(t){this.na(B.Ko,B.cr,t)},this.qa=function(t){this.na(B.Ko,B.fr,t)},this.Ya=function(t){this.ta(B.Yo,t)},this.ts=function(t){this.ta(B.Jo,t)},this.Ja=function(t){this.ta(B.Fo,t)},this.Xa=function(t){this.ta(B.Bo,t)},this.Qa=function(t){this.ta(B.Ho,t)},this.za=function(t){this.ta(B.jo,t)},this.Za=function(t){this.ta(B.xo,t)},this.$a=function(t){this.ta(B.Wo,t)},this.tu=function(t){this.ta(B.qo,t)},this.nu=function(){this.ta(B.Vr,!0)},this.iu=function(t){this.ta(B.Xo,t)},this.setModuleName=function(t){this.na(B.vr,B.Er,t)},this.eu=function(t){this.na(B.vr,B.pr,t)},this.su=function(t){this.ta(B.kr,t)},this.ou=function(t){t&&this.ta(B.Qo,t)},this.ru=function(t){t&&this.ta(B.zo,t)},this.au=function(t){t&&this.ta(B.Zo,t)},this.uu=function(t){t&&this.ta(B.$o,t)},this.hu=function(t){t&&this.ta(B.tr,t)}},K=at.CwsSession=function(){var p=this;p.cu=null,p.pt=null,p.fu=0,p.lu=0,p.du=B.xr.Wr,p.vu=B.Jr.Xr,p.Eu=[],p.pu=-1,p.dn=-2,p.zn=-1,p.gu=-1,p.yu=null,p.vn=a.PlayerState.UNKNOWN,p.fn=-1,p.Au=-1,p.an=null,p.Rn=-1,p.mn=-1,p.ae=null,p.in=null,p.on=null,p.Su=null,p.Ru=null,p.mu={},p.Cu=null,p.Tu=null,p.Iu=null,p.wu=null,p.Nu=null,p.Ou=null,p._u=null,p.Pu=null,p.Du=null,p.bu=null,p.Mu=null,p.Lu=null,p.Vu=null,p.ku=null,p.Uu=null,p.An=null,p.Sn=null,p.w=null,p.N=null,p.Ue=null,p.Fu=null,p.Bu=!1,p.Hu=!1,p.Gu=!1,p.Ku=!1,p.ju=null,p.xu=1e3,p.Wu=0,p.qu=0,p.Yu={},p.C={},p.Ju=!1,p.Xu=null,p.Qu=null,p.zu=null,p.Zu=null,p.$u=null,p.th=null,p.nh=12e4,p.ih=B.Bs,p.eh=!1,p.sh=null,p.ci=null,function(t,n,i,e,s,o,r,a,u,h,c,f,l){this.oh=t,this.Gi=n,this.hi=i,this.l=e,this.l.setModuleName("CwsSession"),this.A=s,this.Ki=o,this.rh=r,this.ah=a,this.uh=u,this.fi=h,this.hh=c,this.pt=f,this.pt&&(p.fn=this.pt.encodedFrameRate,p.an=this.pt.streamUrl,p.Au=this.pt.duration),this.hh&&(p.sh=p.hh.get(q.D)),p.ci=l}.apply(this,arguments),this.ht=function(){this.hh=null,this.fi=null,this.y=null,this.uh=null,this.ah=null,this.rh=null,this.Ki=null,this.A=null,this.l=null,this.hi=null,this.Gi=null,this.oh.ch(),this.oh=null,this.Fu=null,this.Gu=!0},this.fh=function(t){this.lh=t,this.dh=this.lh.dh,this.l.Fn(this.lh.R),this.fu=this.uh.current(),this.vh()||this.Eh()?(this.du+=K.ph,p.l.info("start(): assetName="+p.pt.assetName)):p.l.info("start()"+p.gh())},this.yh=function(){this.Ku=!0},this.Ah=function(){this.l.debug("initialize()"),(this.vh()||this.Eh()||this.Sh())&&(p.Rh(),p.mh(),p.Ch(),(this.vh()||this.Eh())&&p.Th())},this.Ih=function(){this.l.debug("end(): schedule the last hb before session cleanup"+p.gh()),this.wh(),this.Nh(),this.Oh(),this._h()},this.Ph=function(){this.Ku||(this._h(),this.Dh())},this.ba=function(t){var n=p.Cu;n!==t&&t&&(p.l.debug("Change browserName from "+n+" to "+t),p.Cu=t)},this.Ma=function(t){var n=p.Tu;n!==t&&t&&(p.l.debug("Change browserVersion from "+n+" to "+t),p.Tu=t)},this.La=function(t){var n=p.Iu;n!==t&&t&&(p.l.debug("Change deviceBrand from "+n+" to "+t),p.Iu=t)},this.Va=function(t){var n=p.wu;n!==t&&t&&(p.l.debug("Change deviceManufacturer from "+n+" to "+t),p.wu=t)},this.ka=function(t){var n=p.Nu;n!==t&&t&&(p.l.debug("Change deviceModel from "+n+" to "+t),p.Nu=t)},this.Ua=function(t){var n=p.Ou;n!==t&&t&&(p.l.debug("Change deviceType from "+n+" to "+t),p.Ou=t)},this.Fa=function(t){var n=p._u;n!==t&&t&&(p.l.debug("Change deviceVersion from "+n+" to "+t),p._u=t)},this.Ga=function(t){var n=p.bu;n!==t&&t&&(p.l.debug("Change operatingSystemName from "+n+" to "+t),p.bu=t)},this.Ka=function(t){var n=p.Mu;n!==t&&t&&(p.l.debug("Change operatingSystemVersion from "+n+" to "+t),p.Mu=t)},this.ja=function(t){var n=p.Lu;n!==t&&t&&(p.l.debug("Change deviceCategory from "+n+" to "+t),p.Lu=t)},this.xa=function(t){var n=p.Vu;n!==t&&t&&(p.l.debug("Change screenWidth from "+n+" to "+t),p.Vu=t)},this.Wa=function(t){var n=p.ku;n!==t&&t&&(p.l.debug("Change screenHeight from "+n+" to "+t),p.ku=t)},this.qa=function(t){var n=p.Lu;n!==t&&t&&(p.l.debug("Change scaleFactor from "+n+" to "+t),p.Uu=t)},this.bh=function(){return p.Pu},this.Ba=function(t){var n=p.Pu;n!==t&&t&&(p.l.debug("Change frameworkName from "+n+" to "+t),p.Pu=t)},this.Mh=function(){return p.Du},this.Ha=function(t){var n=p.Du;n!==t&&t&&(p.l.debug("Change frameworkVersion from "+n+" to "+t),p.Du=t)},this.Qa=function(t){var n;p.pt.streamUrl||(n=p.an)!==t&&t&&(p.l.debug("Change stream url from "+n+" to "+t),p.an=t)},this.Lh=function(){p.Nh(),p.eh||(p.Vh(),p.th=p.Ki.create(p.Vh,p.nh,"CwsSession.startCdnTimer"),p.l.debug("fetching cdn ip timer started"))},this.Nh=function(){p.th&&(p.th(),p.kh(null,null,null,null,null),p.th=null)},this.Vh=function(){p.l.debug("detectCDNServerIp(): For "+p.an),p.ih?p.Uh():p.Nh()},this.Uh=function(){try{var t;"function"===typeof XMLHttpRequest||"object"===typeof XMLHttpRequest?((t=new XMLHttpRequest).open("HEAD",p.an,!0),t.setRequestHeader("Pragma","akamai-x-cache-on"),t.onreadystatechange=function(){4===this.readyState&&(200===this.status&&(this.getAllResponseHeaders().indexOf("x-cache")>=0||this.getAllResponseHeaders().indexOf("X-Cache")>=0)?p.kh("Akamai","header","X-Cache",""+this.getResponseHeader("X-Cache"),""+this.status):p.kh("null","header","null","null",""+this.status))},t.send()):p.l.info("xmlhttpreq is not available here to fetch CDN Server Ip")}catch(t){p.l.info("Exception caught in makeAkamaiHeadRequest")}},this.kh=function(t,n,i,e,s){var o={},r={};p.Xu!==t&&(null!==p.Xu&&(r[B.Qo]=p.Xu),p.Xu=t,null===p.Xu?o[B.Qo]="null":o[B.Qo]=p.Xu),p.Qu!==n&&(null!==p.Qu&&(r[B.zo]=p.Qu),p.Qu=n,null===p.Qu?o[B.zo]="null":o[B.zo]=p.Qu),p.zu!==i&&(null!==p.zu&&(r[B.Zo]=p.zu),p.zu=i,null===p.zu?o[B.Zo]="null":o[B.Zo]=p.zu),p.Zu!==e&&(null!==p.Zu&&(r[B.$o]=p.Zu),p.Zu=e,null===p.Zu?o[B.$o]="null":o[B.$o]=p.Zu),p.$u!==s&&(null!==p.$u&&(r[B.tr]=p.$u),p.$u=s,null===p.$u?o[B.tr]="null":o[B.tr]=p.$u),"{}"!==JSON.stringify(o)&&p.Fh(o,r)},this.Bh=function(t){var n=p.dn;n!==t&&t>0&&(p.l.info("Change bitrate from "+n+" to "+t),p.Hh(n,t),p.dn=t)},this.Ya=function(t){var n=p.zn;n!==t&&t>=0&&(p.l.info("Change dropped frames total from "+n+" to "+t),p.Gh(n,t),p.zn=t)},this.ts=function(t){var n=p.gu,i=t+(-1===p.gu?0:p.gu);n!==t&&i>=0&&(p.l.info("Change dropped frames count from "+n+" to "+i),p.Kh(n,i),p.gu=i)},this.wa=function(t){var n=p.yu;n!==t&&t&&(p.l.info("Change resource from "+n+" to "+t),p.yu=t)},this.va=function(t){p.in!==t&&t&&(p.l.info("Change assetName from "+p.in+" to "+t),p.in=t)},this.oa=function(t){var n=p.Ru;n!==t&&Q._i(t)&&(p.l.info("Change isLive from "+n+" to "+t),p.Ru=t)},this.da=function(t){var n=p.on;n!==t&&t&&(p.l.info("Change viewerId from "+n+" to "+t),p.on=t)},this.Ea=function(t){var n=p.Su;n!==t&&t&&(p.l.info("Change playerName from "+n+" to "+t),p.Su=t)},this.pa=function(t){var n=p.mu;!Q.jh(n,t)&&t&&(p.l.info("Change tags from "+Q.xh(n)+" to "+Q.xh(t)),p.mu=t)},this.Na=function(t){p.pt.encodedFrameRate>0||(p.l.debug("setEncodedFrameRate(): "+t),p.fn=t)},this.Ta=function(t){p.pt.duration>0||(p.l.debug("setContentLength(): "+t),p.Au=t)},this.Se=function(t){var n;p.Hu||t!==a.PlayerState.PLAYING||(p.Hu=!0,Q.At(p.pt.viewerId)||p.l.error("Missing viewerId. viewerId should be updated before first frame is rendered."),Q.At(p.pt.streamType)&&f.StreamType.UNKNOWN!==p.pt.streamType||p.l.error("Missing streamType - Live or VOD. streamType should be updated before first frame is rendered."),Q.At(p.pt.applicationName)||p.l.error("Missing applicationName. applicationName should be updated before first frame is rendered.")),p.vn!==t&&(n=p.vn,p.l.info("setPlayerState(): changing player state from "+n+" to "+t),p.Wh(n,t),p.vn=t)},this.qh=function(t){var n=p.Rn;n!==t&&t>0&&(p.l.debug("Change stream resolution width from "+n+" to "+t),p.Yh(n,t),p.Rn=t)},this.Jh=function(t){var n=p.mn;n!==t&&t>0&&(p.l.debug("Change stream resolution height from "+n+" to "+t),p.Xh(n,t),p.mn=t)},this.$a=function(t){var n=p.w;n!==t&&t&&(p.l.debug("Change network connection type from "+n+" to "+t),p.Qh(n,t),p.w=t)},this.tu=function(t){var n=p.N;n!==t&&t&&(p.l.debug("Change network link encryption from "+n+" to "+t),p.zh(n,t),p.N=t)},this.su=function(t){p.eh=!0,p.Nh();var n=p.Ue;n!==t&&Q.At(t)&&(p.l.debug("Change CDN Server IP from "+n+" to "+t),p.Zh(n,t),p.Ue=t)},this.$h=function(t){var n;p.l.debug("togglePauseJoin()"),p.Bu!==t?(n=p.Bu,t=!p.Bu,p.tc(n,t),p.Bu=!p.Bu):p.l.debug("togglePauseJoin(): same value, ignoring")},this.nc=function(t,n){p.ic(t,n)},this.ec=function(t,n){var i;n[B.Rr]=t,n[B.Cr]=this.sc(),n[B.mr]=this.oh.oc(),this.ae&&(i=tt.rc(this.ae.getPHT(),0,null,-1),t=tt.rc(this.ae.getBufferLength(),0,null,-1),i>=0&&(n[B.Fo]=i),t>0&&(n[B.Bo]=t)),this.oh.ac(n)},this.uc=function(t){p.ae=t,p.ae?p.hc():p.cc()},this.wh=function(){var t=this.ah.ks(this.fc(),this.sc());this.oh.ac(t)},this.ic=function(t,n){var i={};i[B.wr]=t,i[B.Nr]=n,this.ec(B.qs,i)},this.Hh=function(t,n){var i={},e={};t>0&&(e[B.Do]=t),i[B.Do]=n,this.Fh(i,e)},this.lc=function(t,n){var i={};i[B.Tr]=t,n>=0&&(i[B.Ir]=n),this.ec(B.Js,i)},this.Yh=function(t,n){var i={},e={};-1!==t&&(e[B.jo]=t),i[B.jo]=n,this.Fh(i,e)},this.Xh=function(t,n){var i={},e={};-1!==t&&(e[B.xo]=t),i[B.xo]=n,this.Fh(i,e)},this.Qh=function(t,n){var i={},e={};null!==t&&(e[B.Wo]=t),i[B.Wo]=n,this.Fh(i,e)},this.zh=function(t,n){var i={},e={};null!==t&&(e[B.qo]=t),i[B.qo]=n,this.Fh(i,e)},this.Zh=function(t,n){var i={},e={};Q.At(t)&&(e[B.kr]=t),i[B.kr]=n,this.Fh(i,e)},this.Gh=function(t,n){var i={},e={};t>=0&&(e[B.Yo]=t),i[B.Yo]=n,this.Fh(i,e)},this.Kh=function(t,n){var i={},e={};t>=0&&(e[B.Jo]=t),i[B.Jo]=n,this.Fh(i,e)},this.tc=function(t,n){var i={},e={};e[B._o]=t,i[B._o]=n,this.Fh(i,e)},this.Wh=function(t,n){var i={},e={};i[B.Po]=B.Ur(n),e[B.Po]=B.Ur(t),this.Fh(i,e)},this.Fh=function(t,n){var i={};i[B.Or]=t,n&&Q.Ot(n)>0&&(i[B._r]=n),this.ec(B.Ws,i)},this.dc=function(t,n){var i={};i[B.Pr]=t,Q.Ot(n)>0&&(i[B.Dr]=n),this.ec(B.Ys,i)},this.Oh=function(){p.cu&&(p.cu(),p.cu=null)},this.Dh=function(){p.Oh();var t=1e3*p.hi.heartbeatInterval;p.cu=p.Ki.create(p._h,t,"Session.sendHeartbeat:"+this.dh)},this.cc=function(){p.ju&&(p.ju(),p.ju=null)},this.hc=function(){p.cc(),p.ju=p.Ki.create(p.vc,p.xu,"Session.startRfpsTimer")},this.Ec=function(){var t={err:"pending"};t.seq=p.lu-1,t.sentAt=p.sc(),t.rtt=-1,p.Eu.push(t);for(var n=0;n<p.Eu.length;n++)"ok"===(t=p.Eu[n]).err&&(p.Eu.splice(n,1),n--)},this.pc=function(t,n){for(var i=0;i<p.Eu.length;i++){var e=p.Eu[i];e.seq===t&&(e.rtt=p.sc()-e.sentAt,e.err=n)}},this.gc=function(t){for(var n=0;n<p.Eu.length;n++){var i=p.Eu[n];i.seq===t&&(i.rtt=p.sc()-i.sentAt,i.err="ok")}},this.yc=function(){for(var t,n,i=p.hh.get(q.Ac),e=[],s=-1,o=0;o<p.Eu.length;o++)if("ok"===(n=p.Eu[o]).err){s=n.seq;break}for(var r=0;r<p.Eu.length;r++)((t=(n=p.Eu[r]).seq)<p.lu-i||t<s)&&e.push(r);for(var a=[],u=0;u<p.Eu.length;u++)t=(n=p.Eu[u]).seq,e.indexOf(u)<0&&a.push(p.Eu[u]);p.Eu=a},this.Sc=function(){p.yc();for(var t=[],n=0;n<p.Eu.length;n++){var i=p.Eu[n],e={};e[B.br]=i.seq,e[B.Lr]=i.rtt,e[B.Mr]=i.err,t.push(e)}return t},this.Rc=function(){var t,n=-1,i=-1,e=p.oh.ch();if(p.Sh()&&0===e.length)return null;var s=new G;s.ia(B.uo),s.aa(p.hi.customerKey),s.ua(p.hh.get(q.D)),s.Fn(p.lh.R),s.ra(p.lu),s.ca(B.version);var o=A.version;if(p.ci&&(o=p.ci),s.ha(o),s.la(p.Gi.R),s.fa(0),p.Gi.w?s.$a(p.Gi.w):p.w&&s.$a(p.w),p.Gi.N?s.tu(p.Gi.N):p.N&&s.tu(p.N),Q.At(p.Ue)&&s.su(p.Ue),s.Da(B.xs),p.Cu&&s.ba(p.Cu),p.Tu&&s.Ma(p.Tu),p.Iu&&s.La(p.Iu),p.wu&&s.Va(p.wu),p.Nu&&s.ka(p.Nu),p.Ou&&s.Ua(p.Ou),p._u&&s.Fa(p._u),p.bu&&s.Ga(p.bu),p.Mu&&s.Ka(p.Mu),p.Lu&&s.ja(p.Lu),p.Pu&&s.Ba(p.Pu),p.Du&&s.Ha(p.Du),p.Vu&&!isNaN(p.Vu)&&s.xa(parseInt(p.Vu,10)),p.ku&&!isNaN(p.ku)&&s.Wa(parseInt(p.ku,10)),p.Uu&&!isNaN(p.Uu)?s.qa(parseFloat(p.Uu)):(p.Vu&&!isNaN(p.Vu)||p.ku&&!isNaN(p.ku))&&s.qa(1),p.ae&&(p.An=p.ae.bn(),p.An&&s.setModuleName(p.An),p.Sn=p.ae.Mn(),p.Sn&&s.eu(p.Sn),p.ae.Ln()&&(p.Pu=p.ae.Ln(),s.Ba(p.Pu)),p.ae.kn()&&(p.Du=p.ae.kn(),s.Ha(p.Du))),p.on&&s.da(p.on),Q.Ot(p.mu)>0&&s.pa(p.mu),p.vh()||p.Eh()){p.Eh()&&s.nu(),p.in&&s.va(p.in),s.ga(p.du);o=B.Ur(p.vn);s.Se(o),s.Ca(p.Bu),p.Su&&s.Ea(p.Su),Q._i(p.Ru)&&s.oa(p.Ru),p.Au>0&&s.Ta(p.Au),p.dn>0&&s.Ia(p.dn),null!==p.yu&&s.wa(p.yu),p.fn>0&&s.Na(p.fn),p.ae&&(n=tt.rc(p.ae.getPHT(),0,null,-1),i=tt.rc(p.ae.getBufferLength(),0,null,-1)),Q.dt(p.Gi.O)?t=p.Gi.O:p.ae&&(t=p.ae.getSignalStrength()),n>=0&&s.Ja(n),i>0&&s.Xa(i);i=p.mc();if(i>0&&s.Oa(i),p.qu>0&&s.Pa(tt.rc(p.qu,0,null,-1)),p.Wu>0&&s._a(tt.rc(p.Wu,0,null,-1)),t!==a.DEFAULT_SIGNAL_STRENGTH&&s.iu(t),p.an&&s.Qa(p.an),p.Rn>0&&s.za(p.Rn),p.mn>0&&s.Za(p.mn),p.zn>-1&&s.Ya(p.zn),p.gu>-1&&(s.ts(p.gu),p.gu>0&&(p.Kh(p.gu,0),p.gu=0)),"undefined"!==typeof p.Fu)for(var r in p.Fu)s.ta(r,p.Fu[r])}else s.ga(B.xr.Wr);return e.length>0&&s.Aa(e),s.ya(p.vu),s.Sa(!0),p.hh.get(q.Cc)&&s.Ra(p.fi.ch()),p.hh.get(q.Ac)>0&&((e=p.Sc()).length>0&&s.ma(e)),0===p.lu&&(s=p.Tc(s)),0!==p.lu&&(s=p.Ic(s)),s.sa(p.fu),s.ea(p.sc()),p.ih&&(s.ou(p.Xu),s.ru(p.Qu),s.au(p.zu),s.uu(p.Zu),s.hu(p.$u)),p.lu++,s.get()},this.Ic=function(t){var n,i=p.C,e={};for(n in t.$r.tags)Object.prototype.hasOwnProperty.call(i,n)||(e[n]=t.$r.tags[n]);t.$r.tags=e,p.C={};for(var s=0;s<p.Yu.length;s++)Object.prototype.hasOwnProperty.call(p.Gi.C,p.Yu[s])?Object.prototype.hasOwnProperty.call(p.Gi.I,p.Yu[s])?p.Gi.I[p.Yu[s]]===q.Gt.Kt?(p.C[q.wc+""+p.Yu[s]]=q.Gt.Kt,p.Gi.T("End-user chose to opt-out of personal data collection")):p.Gi.I[p.Yu[s]]===q.Gt.xt?(p.C[q.wc+""+p.Yu[s]]=q.Gt.xt,p.Gi.T("End-user chose to opt-out of personal data collection")):p.Gi.I[p.Yu[s]]===q.Gt.Ht?(p.C[q.wc+""+p.Yu[s]]=q.Gt.Ht,p.Gi.T("End-user used privacy settings and chose to opt-out of personal data collection")):(p.C[q.wc+""+p.Yu[s]]=p.Gi.C[p.Yu[s]],p.Gi.T("Data collection successful")):(p.C[q.wc+""+p.Yu[s]]=p.Gi.C[p.Yu[s]],p.Gi.T("Data collection successful")):p.C[q.wc+""+p.Yu[s]]=q.Gt.Nc;var o,r={};for(o in i){var a=o.split(".");"{}"!==JSON.stringify(p.Yu)&&-1!==p.Yu.indexOf(""+a[2])||i[q.wc+""+a[2]]===q.Gt.Oc||(p.Gi.T("Data collection restricted from Conviva back-end"),p.C[q.wc+""+a[2]]=q.Gt.Oc,r[q.wc+""+a[2]]=q.Gt.Oc)}if("{}"!==JSON.stringify(p.C)){var u,h=Q._c(p.C);for(u in t.$r.tags)h[u]=t.$r.tags[u];if(t.$r.tags=h,!Q.jh(i,p.C)){var c={};if("{}"!==JSON.stringify(r)&&(c[B.Co]=r),"{}"!==JSON.stringify(i)){for(var f in i)p.C[f]&&i[f]!==p.C[f]&&(c[B.Co]||(c[B.Co]={}),c[B.Co][f]=p.C[f]);for(var l in p.C)Object.prototype.hasOwnProperty.call(i,l)&&i[l]===p.C[l]||(c[B.Co]||(c[B.Co]={}),c[B.Co][l]=p.C[l])}"{}"===JSON.stringify(i)&&(c[B.Co]=p.C);var d,v,E={};E[B.Or]=c,E[B.Rr]=B.Ws,E[B.Cr]=p.sc(),E[B.mr]=p.oh.oc(),p.ae&&(d=tt.rc(p.ae.getPHT(),0,null,-1),v=tt.rc(p.ae.getBufferLength(),0,null,-1),d>=0&&(E[B.Fo]=d),v>0&&(E[B.Bo]=v)),t.$r.evs||(t.$r.evs=[]),t.$r.evs.push(E)}}return t},this.Tc=function(t){var n=p.Pc();if("{}"===JSON.stringify(n))return t;var i,e=Q._c(n);for(i in t.$r.tags)e[i]=t.$r.tags[i];t.$r.tags=e;var s={};s[B.Co]=n;var o={};return o[B.Or]=s,o[B.Rr]=B.Ws,o[B.Cr]=p.sc(),o[B.mr]=p.oh.oc(),p.ae&&(n=tt.rc(p.ae.getPHT(),0,null,-1),s=tt.rc(p.ae.getBufferLength(),0,null,-1),n>=0&&(o[B.Fo]=n),s>0&&(o[B.Bo]=s)),t.$r.evs||(t.$r.evs=[]),t.$r.evs.push(o),t},this.Pc=function(){var t={};if("undefined"!==typeof navigator&&navigator){if(t["c3.fp.cookie"]="undefined"!==typeof navigator.cookieEnabled&&navigator.cookieEnabled?""+navigator.cookieEnabled:"",t["c3.fp.memory"]="undefined"!==typeof navigator.deviceMemory&&navigator.deviceMemory?""+navigator.deviceMemory:"",t["c3.fp.hwConc"]="undefined"!==typeof navigator.hardwareConcurrency&&navigator.hardwareConcurrency?""+navigator.hardwareConcurrency:"",t["c3.fp.java"]=""+("function"!==typeof navigator.javaEnabled)?"false":navigator.javaEnabled(),t["c3.fp.lang"]="undefined"!==typeof navigator.language&&navigator.language?""+navigator.language:"",t["c3.fp.langs"]="undefined"!==typeof navigator.languages&&navigator.languages&&navigator.languages.length>0?""+navigator.languages.toString():"",t["c3.fp.maxTp"]="undefined"!==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints?""+navigator.maxTouchPoints:"",t["c3.fp.plugins"]="","undefined"!==typeof navigator.plugins&&navigator.plugins&&navigator.plugins.length>0)for(var n=0;n<navigator.plugins.length;n++)t["c3.fp.plugins"]+=navigator.plugins[n].name+",";if(t["c3.fp.mime"]="","undefined"!==typeof navigator.mimeTypes&&navigator.mimeTypes&&navigator.mimeTypes.length>0)for(var i=0;i<navigator.mimeTypes.length;i++)t["c3.fp.mime"]+=navigator.mimeTypes[i].type+",";t["c3.fp.sysLang"]="undefined"!==typeof navigator.systemLanguage&&navigator.systemLanguage?""+navigator.systemLanguage:"",t["c3.fp.platform"]="undefined"!==typeof navigator.platform&&navigator.platform?""+navigator.platform:"",t["c3.fp.product"]="undefined"!==typeof navigator.product&&navigator.product?""+navigator.product:"",t["c3.fp.productSub"]="undefined"!==typeof navigator.productSub&&navigator.productSub?""+navigator.productSub:"",t["c3.fp.vendor"]="undefined"!==typeof navigator.vendor&&navigator.vendor?""+navigator.vendor:"",t["c3.fp.vendorSub"]="undefined"!==typeof navigator.vendorSub&&navigator.vendorSub?""+navigator.vendorSub:"";var e=p.Dc();""!==e&&(t["c3.fp.canvFp"]=e)}return"undefined"!==typeof window&&window&&("undefined"!==typeof window.screen&&window.screen&&(t["c3.fp.availHeight"]="undefined"!==typeof window.screen.availHeight&&window.screen.availHeight?""+window.screen.availHeight:"",t["c3.fp.availWidth"]="undefined"!==typeof window.screen.availWidth&&window.screen.availWidth?""+window.screen.availWidth:"",t["c3.fp.height"]="undefined"!==typeof window.screen.height&&window.screen.height?""+window.screen.height:"",t["c3.fp.width"]="undefined"!==typeof window.screen.width&&window.screen.width?""+window.screen.width:"",t["c3.fp.colorDepth"]="undefined"!==typeof window.screen.colorDepth&&window.screen.colorDepth?""+window.screen.colorDepth:"",t["c3.fp.deviceXDPI"]="undefined"!==typeof window.screen.deviceXDPI&&window.screen.deviceXDPI?""+window.screen.deviceXDPI:"",t["c3.fp.deviceYDPI"]="undefined"!==typeof window.screen.deviceYDPI&&window.screen.deviceYDPI?""+window.screen.deviceYDPI:""),t["c3.fp.dpi"]="undefined"!==typeof window.devicePixelRatio&&window.devicePixelRatio?""+window.devicePixelRatio:"",t["c3.fp.secure"]="boolean"===typeof window.isSecureContext?""+window.isSecureContext:""),t},this.Dc=function(){try{if("undefined"!==typeof document&&document){var t=document.createElement("CANVAS");if("undefined"!==typeof t&&t&&"function"===typeof t.getContext){var n=t.getContext("2d"),i="conviva";return n.textBaseline="top",n.font="14px Arial",n.textBaseline="alphabetic",n.fillStyle="#f40",n.fillRect("undefined"!==typeof navigator.plugins&&navigator.plugins?navigator.plugins.length:0,"undefined"!==typeof navigator.mimeTypes&&navigator.mimeTypes?navigator.mimeTypes.length:0,"undefined"!==typeof navigator.product&&navigator.product?navigator.product.length:0,"undefined"!==typeof navigator.vendor&&navigator.vendor?navigator.vendor.length:0),n.fillStyle="#069",n.fillText(i,"undefined"!==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>=0?navigator.maxTouchPoints:0,"undefined"!==typeof navigator.product&&navigator.product?navigator.product.length:0),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText(i,"undefined"!==typeof navigator.deviceMemory&&navigator.deviceMemory?navigator.deviceMemory:0,"undefined"!==typeof navigator.hardwareConcurrency&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:0),Q.bc(t.toDataURL())}}return""}catch(t){return""}},this._h=function(){var t;p.Gu||(t=p.Rc())&&p.Mc(t)},this.vc=function(){var t;p.vn!==a.PlayerState.PLAYING||!p.ae||(t=p.ae.getRenderedFrameRate())>0&&(p.qu+=t,p.Wu++)},this.mc=function(){return p.qu>0&&p.Wu>0?Q.Lc.Cast(+p.qu/p.Wu):(this.vc(),p.qu>0&&p.Wu>0?Q.Lc.Cast(+p.qu/p.Wu):a.DEFAULT_RENDERED_FRAME_RATE)},this.Mc=function(t){p.Ec();var i=p.lu-1;p.l.info("postHeartbeat(): Send HB["+i+"]"+p.gh());p.rh.Vc(t,function(t,n){p.kc(t,n,i)})},this.kc=function(e,s,o){p.Gu||p.A.P("onHeartbeatResponse",function(){var t,n,i;e?s?(p.l.debug("onHeartbeatResponse(): received valid response for HB["+o+"]"),p.gc(o),!(i=s[B.Zs])||i!==(t=p.hh.get(q.D))&&(p.l.debug("onHeartbeatResponse(): setting the client id to "+i+" (from gateway)"),p.hh.set(q.D,i),p.hh.Uc(),t===B.M&&i!==B.M&&p.Gi._()),(t=s[B.zs])&&t!==B.Qs&&p.l.error("onHeartbeatResponse(): error from gateway: "+t),"object"===typeof(i=s[B.$s])&&((t=i[B.io])>=0&&p.hh.get(q.Ac)!==t&&(p.l.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+t+" (from gateway)"),p.hh.set(q.Ac,t)),t=i[B.eo],(t=!!Q._i(t)&&t)!==p.hh.get(q.Cc)&&(p.l.debug("onHeartbeatResponse(): turning "+(t?"on":"off")+" sending of logs"),p.hh.set(q.Cc,t)),t=i[B.so],!Q.dt(t)||(n=Q.Lc.Cast(t))!==p.hi.heartbeatInterval&&(p.l.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+n),p.hi.heartbeatInterval=n,p.cu&&p.Dh()),(n=i[B.oo])&&n!==p.hi.gatewayUrl&&(p.l.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+n),p.hi.gatewayUrl=n),p.Fc()||(p.Yu={},(n=i[B.ro])&&(p.Ju||(p.Ju=!0),p.l.debug("onHeartbeatResponse(): received fp from gateway: "+n),p.Yu=n.split(",")),p.ih=i[B.ao],Q._i(p.ih)&&(p.ih?(p.l.debug("onHeartbeatResponse(): enabling the CDN Server IP collection"),p.th||p.Lh()):(p.l.debug("onHeartbeatResponse(): disabling the CDN Server IP collection (from gateway)"),p.Nh()))))):p.l.warning("onHeartbeatResponse(): decoded heartbeat response is null."):(i=s,Q.At(i)?Q.Bc(i,"HTTP timeout")?p.l.warning("onHeartbeatResponse(): "+i):p.l.error("onHeartbeatResponse(): failed to send heartbeat: "+i):(i=j.Hc,p.l.error("onHeartbeatResponse(): "+i)),p.pc(o,i))})},this.sc=function(){return Q.Lc.Cast(p.uh.current()-p.fu)},this.fc=function(){return this.oh.oc()},this.gh=function(){return this.Sh()?" (global session)":""},this.Sh=function(){return this.dh===K.lt.Wr},this.Fc=function(){return this.dh===K.lt.Wr&&"T"===this.mu["c3.IPV4IPV6GlobalSession"]},this.vh=function(){return this.dh===K.lt.ft},this.Eh=function(){return this.dh===K.lt.yt},this.Rt=function(t){p.Gc(t),p.Rh()},this.Gc=function(t){var n={},i={};if(Q.At(t.assetName)&&(p.pt.assetName!==t.assetName?(p.pt.assetName&&(n[B.Ro]=p.pt.assetName),i[B.Ro]=t.assetName,p.pt.assetName=t.assetName):p.l.warning("mergeContentMetadata(): assetName was not changed.")),Q.At(t.applicationName)&&(p.pt.applicationName!==t.applicationName?(p.pt.applicationName&&(n[B.mo]=p.pt.applicationName),i[B.mo]=t.applicationName,p.pt.applicationName=t.applicationName):p.l.warning("mergeContentMetadata(): applicationName was not changed.")),Q.At(t.streamUrl)&&(p.pt.streamUrl!==t.streamUrl?(p.pt.streamUrl&&(n[B.Ho]=p.pt.streamUrl),i[B.Ho]=t.streamUrl,p.pt.streamUrl=t.streamUrl,p.an=p.pt.streamUrl):p.l.warning("mergeContentMetadata(): streamUrl was not changed.")),Q.At(t.viewerId)&&(p.pt.viewerId!==t.viewerId?(p.pt.viewerId&&(n[B.So]=p.pt.viewerId),i[B.So]=t.viewerId,p.pt.viewerId=t.viewerId):p.l.warning("mergeContentMetadata(): viewerId was not changed.")),Q.At(t.defaultResource)&&(p.pt.defaultResource!==t.defaultResource?(p.pt.defaultResource&&(n[B.Uo]=p.pt.defaultResource),i[B.Uo]=t.defaultResource,p.pt.defaultResource=t.defaultResource):p.l.warning("mergeContentMetadata(): defaultResource was not changed.")),Q.dt(t.duration)&&t.duration>0&&(p.pt.duration!==t.duration?(p.Au>0&&(n[B.bo]=p.Au),i[B.bo]=t.duration,p.pt.duration=t.duration,p.Au=p.pt.duration):p.l.warning("mergeContentMetadata(): duration was not changed.")),Q.dt(t.encodedFrameRate)&&t.encodedFrameRate>0&&(p.pt.encodedFrameRate!==t.encodedFrameRate?(p.pt.encodedFrameRate>-1&&(n[B.Mo]=p.pt.encodedFrameRate),i[B.Mo]=t.encodedFrameRate,p.pt.encodedFrameRate=t.encodedFrameRate,p.fn=p.pt.encodedFrameRate):p.l.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),t.streamType!==f.StreamType.UNKNOWN&&(p.pt.streamType!==t.streamType?(p.pt.streamType!==f.StreamType.UNKNOWN&&(p.pt.streamType===f.StreamType.LIVE?n[B.lo]=!0:n[B.lo]=!1),t.streamType===f.StreamType.LIVE?i[B.lo]=!0:i[B.lo]=!1,p.pt.streamType=t.streamType):p.l.warning("mergeContentMetadata(): streamType was not changed.")),Q.Ot(t.custom)>0){var e,s={},o={};for(e in t.custom)p.pt.custom[e]!==t.custom[e]?(s[e]=t.custom[e],p.pt.custom[e]&&(o[e]=p.pt.custom[e]),p.pt.custom[e]=t.custom[e]):p.l.info("mergeContentMetadata(): custom."+e+" was not changed.");Q.Ot(s)>0?(Q.Ot(o)>0&&(n[B.Co]=o),i[B.Co]=s):p.l.warning("mergeContentMetadata(): custom was not changed.")}Q.Ot(i)>0&&this.Fh(i,n)},this.Rh=function(){var t;p.l.debug("setStatesFromContentMetadata()"),p.pt.defaultResource&&this.wa(p.pt.defaultResource),p.pt.streamUrl&&this.Qa(p.pt.streamUrl),p.pt.duration>0&&this.Ta(p.pt.duration),p.pt.encodedFrameRate>0&&this.Na(p.pt.encodedFrameRate),p.pt.streamType!==f.StreamType.UNKNOWN&&(t=p.pt.streamType===f.StreamType.LIVE,this.oa(t)),p.pt.assetName&&this.va(p.pt.assetName),p.pt.viewerId&&this.da(p.pt.viewerId),(p.pt.applicationName||p.pt.playerName)&&this.Ea(p.pt.applicationName||p.pt.playerName),Q.Ot(p.pt.custom)>0&&this.pa(p.pt.custom)},this.mh=function(){var t={};if(this.Sh()||(p.pt.assetName?t[B.Ro]=p.pt.assetName:p.l.warning("enqueueEventForContentMetadata(): assetName was not set."),p.pt.applicationName?t[B.mo]=p.pt.applicationName:p.l.warning("enqueueEventForContentMetadata(): applicationName was not set."),p.pt.streamUrl?t[B.Ho]=p.pt.streamUrl:p.l.warning("enqueueEventForContentMetadata(): streamUrl was not set."),p.pt.viewerId?t[B.So]=p.pt.viewerId:p.l.warning("enqueueEventForContentMetadata(): viewerId was not set."),p.pt.defaultResource?t[B.Uo]=p.pt.defaultResource:p.l.warning("enqueueEventForContentMetadata(): defaultResource was not set."),p.pt.duration>-1?t[B.bo]=p.pt.duration:p.l.warning("enqueueEventForContentMetadata(): duration was not set."),p.pt.encodedFrameRate>-1?t[B.Mo]=p.pt.encodedFrameRate:p.l.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),p.pt.streamType!==f.StreamType.UNKNOWN?p.pt.streamType===f.StreamType.LIVE?t[B.lo]=!0:t[B.lo]=!1:p.l.warning("enqueueEventForContentMetadata(): streamType was not set.")),Q.Ot(p.pt.custom)>0)for(var n in t[B.Co]={},p.pt.custom)t[B.Co][n]=p.pt.custom[n];else this.Sh()||p.l.warning("enqueueEventForContentMetadata(): custom tags were not set.");Q.Ot(t)>0&&this.Fh(t,null)},this.Th=function(){p.pt&&Q.At(p.pt.assetName)||p.l.warning("Missing assetName during session creation"),p.pt&&Q.At(p.pt.defaultResource)||p.l.warning("Missing resource during session creation"),p.pt&&Q.At(p.pt.streamUrl)||p.l.warning("Missing streamUrl during session creation"),(!p.pt||p.pt.encodedFrameRate<=0)&&p.l.warning("Missing encodedFrameRate during session creation"),p.pt&&Q.At(p.pt.viewerId)||p.l.warning("Missing viewerId during session creation"),p.pt&&p.pt.streamType&&f.StreamType.UNKNOWN!==p.pt.streamType||p.l.warning("Missing streamType during session creation"),p.pt&&Q.At(p.pt.applicationName)||p.l.warning("Missing applicationName during session creation"),(!p.pt||p.pt.duration<=0)&&p.l.warning("Missing duration during session creation")},this.Bt=function(t,n){p.Fu||(p.Fu={}),p.Fu[t]=n},this.Ch=function(){var t={};p.Gi.w&&(t[B.Wo]=p.Gi.w,p.w=p.Gi.w),p.Gi.N&&(t[B.qo]=p.Gi.N,p.N=p.Gi.N),Q.Ot(t)>0&&this.Fh(t,null)}};K.ph=B.xr.ft+B.xr.qr+B.xr.Yr,K.lt={ft:"Video",Wr:"Global",yt:"Ad"};var j=at.Session=function(){var e=this;e.ae=null,e.R=0,e.dh=K.lt.ft,e.Kc=!1,e.Gu=!1,e.jc=!1,e.xc=null,e.ji=null,e.Wc=null,e.qc=!1,e.Yc=a.PlayerState.NOT_MONITORED,e.Jc=!1,e.Xc=!1,e.Qc=!1,e.zc=!1,e.Zc=!1,function(t,n,i,e,s,o,r){this.R=t,this.dh=n,this.hh=i,this.$c=e,this.Et=s,this.A=o,this.l=r,this.l.setModuleName("Session"),this.l.Fn(Q.gt(this.R))}.apply(e,arguments),this.fh=function(t,n){e.Et.fh(this),t&&e.Tt(t),e.hh.tf()?e.nf(n):e.hh.if(function(){e.nf(n)})},this.cleanup=function(){e.l.info("cleanup()"+e.gh()),e.Kc=!0,e.Et.yh(),e.hh.tf()?e.ef():e.hh.if(function(){e.ef()})},this.sf=function(){e.l.debug("cleanupAll()"+e.gh()),(e.vh()||e.Eh())&&e.ae&&e.rf(),e.l.Fn(null),e.l=null,e.A=null,e.Gi=null,e.hh=null,e.$c=null,e.Et.ht(),e.Et=null,e.Gu=!0},this.ef=function(){e.Et.Ih(),e.sf()},this.nf=function(t){e.Et.Ah(),e.af(),t?(e.St(t.Ds(),t.bs()),e.Et.Se(a.PlayerState.STOPPED),e.Et.Ih(),e.sf()):e.Et.Ph()},this.af=function(){e.l.debug("setStatesFromSystemMetadata()");var t=e.$c.get(),n=t[st.BROWSER_NAME];n&&e.Et.ba(n);n=t[st.BROWSER_VERSION];n&&e.Et.Ma(n);n=t[st.DEVICE_BRAND];n&&e.Et.La(n);n=t[st.DEVICE_MANUFACTURER];n&&e.Et.Va(n);n=t[st.DEVICE_MODEL];n&&e.Et.ka(n);n=t[st.DEVICE_TYPE];n&&e.Et.Ua(n);n=t[st.DEVICE_VERSION];n&&e.Et.Fa(n);n=t[st.FRAMEWORK_NAME];n&&e.Et.Ba(n);n=t[st.FRAMEWORK_VERSION];n&&e.Et.Ha(n);n=t[st.OPERATING_SYSTEM_NAME];n&&e.Et.Ga(n);n=t[st.OPERATING_SYSTEM_VERSION];n&&e.Et.Ka(n);n=t[st.DEVICE_CATEGORY];n&&e.Et.ja(n);n=t[st.SCREEN_WIDTH];n&&e.Et.xa(n);n=t[st.SCREEN_HEIGHT];n&&e.Et.Wa(n);t=t[st.SCALE_FACTOR];t&&e.Et.qa(t)},this.jn=function(t){e.l.debug("onPlayerStateChange(): "+t),e.Et.vn!==t&&(e.Et.vn===a.PlayerState.NOT_MONITORED&&t!==a.PlayerState.NOT_MONITORED&&(e.Yc=t),e.qc?e.l.debug("onPlayerStateChange(): "+t+" (pooled, "+(e.jc?"ad playing":"preloading")+")"):e.Et.Se(t))},this.xn=function(t){e.l.debug("onBitrateChange(): "+t),e.Jc?e.l.info("onBitrateChange(): ignored"):e.Et.Bh(t)},this.Zn=function(t){e.l.debug("onDroppedFramesTotalChange(): "+t),e.Xc?e.l.info("onDroppedFramesTotalChange(): ignored"):e.Et.Ya(t)},this.$n=function(t){e.l.debug("onDroppedFramesCountChange(): "+t),e.Xc?e.l.info("onDroppedFramesCountChange(): ignored"):e.Et.ts(t)},this.Wn=function(t,n){Q.dt(n)||(e.l.warning("onSeekEvent(): Ignored non-integer seekToPosition data: "+n),n=-1),e.Et.lc(t,n)},this.Nn=function(t){e.l.debug("onEncodedFrameRateChange(): "+t),t>0?e.zc?e.l.info("onEncodedFrameRateChange(): Ignored encoded frame rate data: "+t+" (ads)"):(e.Et.Na(t),e.l.info("onEncodedFrameRateChange(): Received encoded frame rate data: "+t)):e.l.warning("onEncodedFrameRateChange(): Ignored invalid encoded frame rate data: "+t)},this.Pn=function(t){e.l.debug("onContentLengthChange(): "+t),t>0?e.zc?e.l.info("setContentLength(): Ignored content length data: "+t+" (ads)"):(e.Et.Ta(t),e.l.info("setContentLength(): Received content length data: "+t)):e.l.warning("setContentLength(): Ignored invalid content length data: "+t)},this.Dn=function(t){e.l.debug("onStreamUrlChange(): "+t),e.Et.Qa(t)},this.qn=function(t){e.l.debug("onStreamResolutionWidthChange(): "+t),e.Et.qh(t)},this.Yn=function(t){e.l.debug("onStreamResolutionHeightChange(): "+t),e.Et.Jh(t)},this.Y=function(t){e.l.debug("onConnectionTypeChange(): "+t),e.Et.$a(t)},this.X=function(t){e.l.debug("onLinkEncryptionChange(): "+t),e.Et.tu(t)},this.Vn=function(t){e.l.debug("onPlayerTypeChange(): "+t),e.Et.bh()||e.Et.Ba(t)},this.Un=function(t){e.l.debug("onPlayerVersionChange(): "+t),e.Et.Mh()||e.Et.Ha(t)},this.Xn=function(t){e.l.debug("onCDNServerIPChange(): "+t),e.Et.su(t)},this.Jn=function(t,n){e.l.debug("onError(): "+t+" ("+n+")"),e.St(t,n)},this.In=function(){e.l.debug("onRelease()"),e.rf()},this.bt=function(t,n,i){e.l.debug("adStart(): adStream="+t+" adPlayer="+n+" adPosition="+i),e.jc?e.l.warning("adStart(): multiple _adStart calls, ignoring"):(e.jc=!0,e.xc=t,e.ji=n,e.Wc=i,e.Et.$h(!0),e.xc===h.AdStream.CONTENT||e.ji===h.AdPlayer.SEPARATE?(e.Et.vn!==a.PlayerState.NOT_MONITORED&&(e.Yc=e.Et.vn),e.Et.Se(a.PlayerState.NOT_MONITORED),e.qc=!0):e.xc===h.AdStream.SEPARATE&&e.ji===h.AdPlayer.CONTENT&&(e.Et.vn!==a.PlayerState.NOT_MONITORED&&(e.Yc=e.Et.vn),e.Et.Se(a.PlayerState.NOT_MONITORED),e.qc=!0,e.Jc=!0,e.Xc=!0,e.zc=!0,e.Qc=!0))},this.Mt=function(){e.l.debug("adEnd()"),e.jc?(e.Et.$h(!1),e.xc===h.AdStream.CONTENT||e.ji===h.AdPlayer.SEPARATE?e.uf||(e.qc=!1,e.Et.Se(e.Yc)):e.xc===h.AdStream.SEPARATE&&e.ji===h.AdPlayer.CONTENT&&(e.Jc=!1,e.Xc=!1,e.zc=!1,e.Qc=!1,e.Zc=!1,e.uf||(e.qc=!1,e.Et.Se(e.Yc))),e.jc=!1,e.xc=e.ji=e.Wc=null):e.l.warning("adEnd(): called before _adStart, ignoring")},this.mt=function(){e.l.debug("detachPlayer()"),e.ae?e.ae&&(e.A.P("Session.detachPlayer",function(){e.ae.wn()}),e.ae=null,e.Et.uc(null),e.Et.Se(a.PlayerState.NOT_MONITORED)):e.l.error("detachPlayer(): called before attachPlayer, ignoring")},this.rf=function(){e.ae&&(e.A.P("Session.releasePlayerStateManager",function(){e.ae.wn()}),e.ae=null,e.Et.uc(null),e.Et.Se(a.PlayerState.NOT_MONITORED))},this.Ct=function(){e.l.debug("offFocus()"),e.Et.$h(!0),e.Et.vn!==a.PlayerState.NOT_MONITORED&&(e.Yc=e.Et.vn),e.Et.Se(a.PlayerState.NOT_MONITORED),e.qc=!0},this.Tt=function(t){e.l.debug("attachPlayer()"),e.ae?e.l.error("attachPlayer(): detach current PlayerStateManager first"):t instanceof a?e.A.P("Session.attachPlayer()",function(){t.setMonitoringNotifier(e,e.R)?(t.Bn(),e.ae=t,e.Et.uc(e.ae)):e.l.error("attachPlayer(): instance of PlayerStateManager is already attached to a session")}):e.l.error("attachPlayer(): Incorrect PlayerStateManager instance")},this.It=function(){e.l.debug("onFocus()"),e.Et.$h(!1),e.Jc=!1,e.Xc=!1,e.zc=!1,e.Qc=!1,e.Zc=!1,e.uf||(e.qc=!1,e.Yc!==a.PlayerState.NOT_MONITORED&&e.Et.Se(e.Yc))},this.Vt=function(){return e.l.debug("getPlayerStateManager()"),e.ae},this.wt=function(){e.l.debug("contentPreload()"),e.uf?e.l.debug("contentPreload(): called twice, ignoring"):(e.uf=!0,e.qc=!0)},this.Nt=function(){e.l.debug("contentStart()"),e.uf?(e.uf=!1,e.jc||(e.qc=!1,e.Yc!==a.PlayerState.NOT_MONITORED&&e.Et.Se(e.Yc))):e.l.warning("contentStart(): called without _contentPreload, ignoring")},this.St=function(t,n){var i;e.l.info("reportError(): "+t),Q.At(t)?n===h.ErrorSeverity.FATAL||n===h.ErrorSeverity.WARNING?e.Zc?e.l.debug("reportError(): ignored"):(i=n===h.ErrorSeverity.FATAL,e.Et.nc(t,i)):e.l.error("reportError(): invalid error severity: "+n):e.l.error("reportError(): invalid error message string: "+t)},this.Rt=function(t){e.A.P("Session.updateContentMetadata",function(){e.Et.Rt(t)})},this.Dt=function(t,n){e.l.info("sendEvent(): eventName="+t+e.gh()),e.Et.dc(t,n)},this.Sh=function(){return e.dh===K.lt.Wr},this.vh=function(){return e.dh===K.lt.ft},this.Eh=function(){return e.dh===K.lt.yt},this.gh=function(){return e.Sh()?" (global session)":""},this.Ut=function(){return this.R},this.Ft=function(){var t=null;return e.hh.tf()&&(t=e.hh.get(q.D)),t},this.Bt=function(t,n){e.Et.Bt(t,n)}};j.Hc="received no response (or a bad response) to heartbeat POST request";var x=at.SessionFactory=function(){var o=this;o.l=null,o.fi=null,o.hf=0,o.cf=null,function(t,n,i,e){o.Gi=t,o.hi=n,o.hh=i,o.v=e,o.l=o.v.buildLogger(),o.l.setModuleName("SessionFactory"),o.hf=0,o.cf={}}.apply(o,arguments),this.ht=function(){for(var t in o.l=null,o.fi=null,o.cf)o.cf[t].cleanup();o.cf=null,o.hf=0},this.ff=function(){var t=o.hf;return o.hf++,t},this.ct=function(t,n,i,e,s){return t||(t=new f),o.lf(t,n,i,e,s)},this.B=function(t){return o.lf(t,K.lt.Wr,void 0,A.version)},this.df=function(){return $.vf()},this.lf=function(t,n,i,e,s){t=o.v.Ti(o.Gi,o.hi,o.hh,o.df(),n,t.tt(),e),e=o.ff();return"undefined"!==typeof s&&"undefined"!==typeof s.error?t.fh(i,s.error):(o.Ef(e,t),t.fh(i)),e},this.Pt=function(t){t=o.cf[t];return t||o.l.error("Client: invalid sessionKey. Did you cleanup that session previously?"),t},this.vt=function(t){t=this.Pt(t);return t&&(t.vh()||t.Eh()||(o.l.error("Client: invalid Video sessionKey. Did you cleanup that session previously?"),t=null)),t},this.Ef=function(t,n){o.cf[t]=n},this.pf=function(t){delete o.cf[t]},this.Lt=function(t){var n=o.Pt(t);o.pf(t),n.cleanup()},this.q=function(){return o.cf}},W=at.gf=function(t){this.Ki=t,this.yf=function(i,t,n){var e=!1;this.Ki.createOnce(function(){e||i(!(e=!0),n+" ("+t+" ms)")},t,"CallbackWithTimeout.wrap");return function(t,n){e||(e=!0,i(t,n))}}},q=at.Config=function(t,n,i){var e=this;this.l=t,this.l.setModuleName("Config"),this.Af=n,this.Sf=i,this.Rf={clientId:B.M,sendLogs:!1,maxHbInfos:B.Hs},this.S=Q._c(this.Rf),this.mf=!1,this.Cf=!1,this.Tf=[],this.tf=function(){return this.mf},this.rt=function(){this.Af.rt(q.If,function(t,n){t?(e.wf(n),e.l.debug("load): configuration successfully loaded from local storage"+(e.Cf?" (was empty)":"")+".")):e.l.error("load): error loading configuration from local storage: "+n),e.mf=!0,e.Nf()})},this.wf=function(t){t=this.Sf.zr(t);t?(t=t[q.Of])&&t!==B.M&&""!==t&&"null"!==t&&(this.S[q.D]=t,this.l.debug("parse(): loaded clientId="+t+" (from local storage)")):this.Cf=!0},this._f=function(){var t={};return t[q.Of]=this.S.clientId,this.l.debug("marshall(): saving clientId="+this.S.clientId+" (to local storage)"),this.Sf.Qr(t)},this.Uc=function(){this.Af.Uc(q.If,this._f(),function(t,n){t?e.l.debug("save(): configuration successfully saved to local storage."):e.l.error("save(): error saving configuration to local storage: "+n)})},this.if=function(t){this.tf()?t():this.Tf.push(t)},this.get=function(t){return this.mf?this.S[t]:null},this.set=function(t,n){this.mf&&(this.S[t]=n)},this.Nf=function(){for(var t;"undefined"!==typeof(t=this.Tf.shift());)t()}};q.If="sdkConfig",q.Of="clId",q.D="clientId",q.Cc="sendLogs",q.Ac="maxHbInfos",q.wc="c3.fp.",q.Gt={Nc:"0",Pf:"1",Kt:"2",Ht:"3",Oc:"4",xt:"5",jt:"6"};var Y=at.EventQueue=function(){this.Df=[],this.bf=0,this.ac=function(t){this.Df.push(t)},this.oc=function(){var t=this.bf;return this.bf++,t},this.ch=function(){var t=this.Df;return this.Df=[],t}},J=at.ExceptionCatcher=function(t,n,i){this.l=t,this.l.setModuleName("ExceptionCatcher"),this.Mf=n,this.y=i,this.P=function(n,t,i){try{t()}catch(t){if(i)i(t);else{if(this.y.allowUncaughtExceptions)throw t;this.Lf(n,t)}}},this.Lf=function(t,n){var i="Uncaught exception: "+t+": "+n.toString();if(this.Mf)try{this.Mf.Vc(i)}catch(t){this.l.error("Caught exception while sending ping: "+t.toString())}this.l.error(i)}},X=at.GatewayControl=function(t,n,i,e,s){var o=this;this.hi=t,this.l=n,this.l.setModuleName("GatewayControl"),this.Vf=i,this.Sf=e,this.kf=s,this.Vc=function(t,e){var n=(this.kf?this.kf.indexOf("ipv4")>-1?this.hi.L:this.hi.H:this.hi.gatewayUrl)+B.Fs;this.Vf.Uf("POST",n,this.Sf.Qr(t),"application/json",function(t,n){var i;t?(i=o.Sf.zr(n),e(t,i)):e(t,n)})}},Q=at.Lang={};Q.Ff=function(t){return Q.At(t)&&t&&"undefined"!==t&&"null"!==t},Q._t=function(t){var n,i,e={};for(n in t)Q.Ff(n)&&(i=t[n],Q.Ff(i)&&(e[n]=i));return e},Q.On=function(t,n,i){if(!t)throw new Error("Expected "+i+" implementation is null.");for(var e in n)if("function"!==typeof t[e])throw new Error("Expected method "+e+" in "+i+" implementation.")},Q.Ot=function(t){var n,i=0;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&i++;return i},Q.gt=function(t){return""+t},Q.Bf=function(t){return Math.floor(t)},Q.Qt=function(t){return Math.abs(Q.Bf(t))},Q.Hf=function(t){return Boolean(t)},Q.At=function(t){return"string"===typeof t&&""!==t},Q.Bc=function(t,n){return"string"===typeof t&&"string"===typeof n&&("function"===typeof t.indexOf&&0===t.indexOf(n))},Q._i=function(t){return"boolean"===typeof t},Q.Gf=function(t){return escape(t)},Q.Zr=function(t){return"object"===typeof t},Q.xh=function(t){var n,i="";for(n in t)i+=n+"="+t[n];return"Object{"+i+"}"},Q.Kf=function(t){var n,i=Q._c(t);for(n in i)i[n]||delete i[n];return i},Q._c=function(t){var n,i={};for(n in t)i[n]=t[n];return i},Q.jh=function(t,n){if(typeof t!==typeof n)return!1;if(t instanceof Object&&n instanceof Object){if(Q.Ot(t)!==Q.Ot(n))return!1;for(var i in t)if(!(t[i]===n[i]))return!1;return!0}return t===n},Q.fs=function(){for(var t={},n=0;n<arguments.length;n++)for(var i in arguments[n])arguments[n][i]&&(t[i]=arguments[n][i]);return t},Q.dt=function(t){return"number"===typeof t&&Math.round(t)===t},Q.jf=function(t){return"[object Array]"===Object.prototype.toString.call(t)},Q.xf=function(t,n){if(t===n)return!0;if(!t||!n)return!1;if(t.length!==n.length)return!1;for(var i=0;i<t.length;++i)if(Q.jf(t[i])&&Q.jf(n[i])){if(!Q.xf(t[i],n[i]))return!1}else if(t[i]!==n[i])return!1;return!0},Q.Wf=function(){return"undefined"!==typeof Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}()},Q.qt=function(t,n,i){if(Q.Wf())Object.defineProperty(t,n,{configurable:!0,enumerable:!0,get:i});else{if("undefined"===typeof t.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");t.__defineGetter__(n,i)}},Q.Yt=function(t,n,i){if(Q.Wf())Object.defineProperty(t,n,{configurable:!0,set:i});else{if("undefined"===typeof t.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");t.__defineSetter__(n,i)}},Q.bc=function t(n){function i(t,n){return t>>>n|t<<32-n}for(var e,s,o,r=Math.pow,a=r(2,32),u="length",h="",c=[],f=8*n[u],l=t.h=t.h||[],d=t.k=t.k||[],v=d[u],E={},p=2;v<64;p++)if(!E[p]){for(e=0;e<313;e+=p)E[e]=p;l[v]=r(p,.5)*a|0,d[v++]=r(p,1/3)*a|0}for(n+="\0";n[u]%64-56;)n+="\0";for(e=0;e<n[u];e++){if((s=n.charCodeAt(e))>>8)return null;c[e>>2]|=s<<(3-e)%4*8}for(c[c[u]]=f/a|0,c[c[u]]=f,s=0;s<c[u];){var g=c.slice(s,s+=16),y=l;for(l=l.slice(0,8),e=0;e<64;e++){o=g[e-15],R=g[e-2];var A=l[0],S=l[4],R=l[7]+(i(S,6)^i(S,11)^i(S,25))+(S&l[5]^~S&l[6])+d[e]+(g[e]=e<16?g[e]:g[e-16]+(i(o,7)^i(o,18)^o>>>3)+g[e-7]+(i(R,17)^i(R,19)^R>>>10)|0);(l=[R+((i(A,2)^i(A,13)^i(A,22))+(A&l[1]^A&l[2]^l[1]&l[2]))|0].concat(l))[4]=l[4]+R|0}for(e=0;e<8;e++)l[e]=l[e]+y[e]|0}for(e=0;e<8;e++)for(s=3;s+1;s--){var m=l[e]>>8*s&255;h+=(m<16?0:"")+m.toString(16)}return h},function(){var n={two32:4294967296};n.qf=n.two32-1,n.Yf=0,Q.Jf=n,Q.Jf.Cast=function(t){t=parseInt(t,10);return t>n.qf?t=t%n.two32:t<n.Yf&&(t=-t%n.two32,t=n.two32-t),t},Q.Jf.Xf=function(t){t=parseInt(t,10);return t<=n.qf&&t>=n.Yf};var i={qf:2147483647,Yf:-2147483648};Q.Lc=i,Q.Lc.Cast=function(t){t=parseInt(t,10);return t>i.qf?t=t%i.qf:t<i.Yf&&(t=-t%i.qf,t=i.qf-t),t},Q.Lc.Xf=function(t){t=parseInt(t,10);return t<=i.qf&&t>=i.Yf},Q.Ps=function(){return window&&window.location&&window.location.search?window.location.search:""},Q.Qf=function(){return document&&document.referrer?document.referrer:""}}();var z=at.LogBuffer=function(){this.zf=[],this.Zf=function(t){this.zf.length>=32&&this.zf.shift(),this.zf.push(t)},this.ch=function(){var t=this.zf;return this.zf=[],t}},Z=at.Ping=function(t,n,i,e){this.$f=!1,this.tl=null,this.l=t,this.l.setModuleName("Ping"),this.Vf=n,this.hi=i,this.ci=e,this.Vc=function(t){this.$f||(this.$f=!0,t=this.nl()+"&d="+Q.Gf(t.toString()),this.l.error("send(): "+t),this.Vf.Uf("GET",t,null,null,null),this.$f=!1)},this.nl=function(){if(!this.tl){var t=Z.il+"?comp="+Z.el+"&clv="+(this.ci||h.version);if(this.hi&&(t+="&cid="+this.hi.customerKey),t+="&sch="+B.xs,!this.hi)return t;this.tl=t}return this.tl}};Z.el="sdkjs",Z.il="https://pings.conviva.com/ping.ping";var $=at.sl={};$.ol=4294967295,$.rl=2147483647,$.al=-2147483648,$.vf=function(){return Math.floor(Math.random()*$.ol)+$.al},$.et=function(){return Math.floor(Math.random()*$.ol)};var tt=at.ul={};tt.rc=function(t,n,i,e){if(isNaN(t))return e;if("number"!==typeof t)return e;if(t===e)return e;t=Q.Bf(t);return tt.hl(t,n,i)},tt.hl=function(t,n,i){return Q.dt(i)&&t>i?t=i:Q.dt(n)&&t<n&&(t=n),t},tt.cn=function(t){return-1===t||-2===t?t:t=tt.rc(t,0,null,-1)};var nt=at.StreamerError=function(){var i=this;i.errorCode=null,i.severity=h.ErrorSeverity.FATAL,function(t,n){i.errorCode=t,i.severity=n}.apply(i,arguments),this.Ds=function(){return i.errorCode},this.bs=function(){return i.severity}},it=at.HttpClient=function(t,n,i,e){this.l=t,this.l.setModuleName("HttpClient"),this.ei=n,this.cl=i,this.y=e,this.Uf=function(t,n,i,e,s){var o=1e3*this.y.httpTimeout,r=null;s&&(r=this.cl.yf(s,o,"HTTP timeout")),this.l.debug("request(): calling HttpInterface.makeRequest"),this.ei.makeRequest(t,n,i,e,o,r)}},et=at.Logger=function(t,n,i,e,s){this.ri=t,this.ni=n,this.g=i,this.fi=e,this.ui=s,this.debug=function(t){this.log(t,y.LogLevel.DEBUG)},this.info=function(t){this.log(t,y.LogLevel.INFO)},this.warning=function(t){this.log(t,y.LogLevel.WARNING)},this.error=function(t){this.log(t,y.LogLevel.ERROR)},this.log=function(t,n){t=this.fl(t,n);this.fi.Zf(t),this.g.logLevel<=n&&this.ri.consoleLog(t,n)},this.ll=function(t){return"["+this.An+"] "+t},this.dl=function(t){return"["+this.ui+"] "+t},this.vl=function(t){return"[Conviva] "+t},this.El=function(t){return"["+(this.ni.getEpochTimeMs()/1e3).toFixed(3).toString()+"] "+t},this.pl=function(t,n){return"["+et.gl(n)+"] "+t},this.yl=function(t){return this.Al&&(t="sid="+this.Al+" "+t),t},this.Fn=function(t){this.Al=t},this.setModuleName=function(t){this.An=t},this.fl=function(t,n){return this.vl(this.El(this.pl(this.dl(this.ll(this.yl(t))),n)))}};et.gl=function(t){var n;switch(t){case y.LogLevel.ERROR:n="ERROR";break;case y.LogLevel.WARNING:n="WARNING";break;case y.LogLevel.INFO:n="INFO";break;case y.LogLevel.DEBUG:n="DEBUG"}return n},at.Storage=function(t,n,i,e){this.l=t,this.l.setModuleName("Storage"),this.si=n,this.cl=i,this.y=e,this.rt=function(t,n){n=this.cl.yf(n,1e3*this.y.storageTimeout,"storage load timeout");this.l.debug("load): calling StorageInterface.loadData"),this.si.loadData(at.Storage.Sl,t,n)},this.Uc=function(t,n,i){i=this.cl.yf(i,1e3*this.y.storageTimeout,"storage save timeout");this.l.debug("save(): calling StorageInterface.saveData"),this.si.saveData(at.Storage.Sl,t,n,i)}},at.Storage.Sl="Conviva";var st=at.SystemMetadata=function(t,n,i){this.l=t,this.l.setModuleName("SystemMetadata"),this.oi=n,this.A=i,this.Rl=null,this.get=function(){return this.Rl||this.retrieve(),this.Rl},this.retrieve=function(){var t={};t[st.BROWSER_NAME]=this.oi.getBrowserName,t[st.BROWSER_VERSION]=this.oi.getBrowserVersion,t[st.DEVICE_BRAND]=this.oi.getDeviceBrand,t[st.DEVICE_MANUFACTURER]=this.oi.getDeviceManufacturer,t[st.DEVICE_MODEL]=this.oi.getDeviceModel,t[st.DEVICE_TYPE]=this.oi.getDeviceType,t[st.DEVICE_VERSION]=this.oi.getDeviceVersion,t[st.FRAMEWORK_NAME]=this.oi.getFrameworkName,t[st.FRAMEWORK_VERSION]=this.oi.getFrameworkVersion,t[st.OPERATING_SYSTEM_NAME]=this.oi.getOperatingSystemName,t[st.OPERATING_SYSTEM_VERSION]=this.oi.getOperatingSystemVersion,t[st.DEVICE_CATEGORY]=this.oi.getDeviceCategory,t[st.SCREEN_WIDTH]=this.oi.getScreenWidth,t[st.SCREEN_HEIGHT]=this.oi.getScreenHeight,t[st.SCALE_FACTOR]=this.oi.getScaleFactor;var n,e=this;for(n in this.l.debug("retrieve(): calling MetadataInterface methods"),t)!function(n,i){e.A.P("Session.getSystemMetadataSchema(): "+n,function(){var t=i[n];i[n]=t.call(e.oi)})}(n,t),Q.At(t[n])||delete t[n];var i=!1;if("undefined"!==typeof t[st.DEVICE_TYPE]){for(var s in h.DeviceType)if(t[st.DEVICE_TYPE]===h.DeviceType[s]){i=!0;break}i||delete t[st.DEVICE_TYPE]}if(i=!1,"undefined"!==typeof t[st.DEVICE_CATEGORY]){for(var o in h.DeviceCategory)if(t[st.DEVICE_CATEGORY]===h.DeviceCategory[o]){i=!0;break}i||delete t[st.DEVICE_CATEGORY]}this.Rl=Q.Kf(t)}};st.BROWSER_NAME="browserName",st.BROWSER_VERSION="browserVersion",st.DEVICE_BRAND="deviceBrand",st.DEVICE_MANUFACTURER="deviceManufacturer",st.DEVICE_MODEL="deviceModel",st.DEVICE_TYPE="deviceType",st.DEVICE_VERSION="deviceVersion",st.FRAMEWORK_NAME="frameworkName",st.FRAMEWORK_VERSION="frameworkVersion",st.OPERATING_SYSTEM_NAME="operatingSystemName",st.OPERATING_SYSTEM_VERSION="operatingSystemVersion",st.DEVICE_CATEGORY="deviceCategory",st.SCREEN_WIDTH="screenWidth",st.SCREEN_HEIGHT="screenHeight",st.SCALE_FACTOR="scaleFactor";var ot=at.Time=function(t,n){this.ni=t,this.l=n,this.l.setModuleName("Time"),this.current=function(){var t=this.ni.getEpochTimeMs();return Q.dt(t)||this.l.error("current(): TimeInterface.getEpochTimeMs() did not return an integer ("+t+")"),t}},rt=at.Timer=function(t,n,i){var s=this;this.l=t,this.l.setModuleName("Timer"),this.ii=n,this.A=i,this.create=function(t,n,i){return this.createTimer(function(){s.A.P(i,function(){t()})},n,i)},this.createOnce=function(t,n,i){var e={cancel:null};return e.cancel=this.createTimer(function(){s.A.P(i,function(){e&&"function"===typeof e.cancel&&(e.cancel(),e.cancel=null,e=null),t()})},n,i),e.cancel},this.createTimer=function(t,n,i){return this.l.debug("createTimer(): calling TimerInterface.create"),this.ii.createTimer(t,n,i)}}}()}(),ut});